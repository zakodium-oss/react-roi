{"version":3,"file":"RoiProvider-d71e6690.js","sources":["../../node_modules/react-kbs/lib-esm/utils/cleanShortcuts.js","../../node_modules/react-kbs/lib-esm/utils/macInterop.js","../../node_modules/react-kbs/lib-esm/utils/makeKey.js","../../node_modules/react-kbs/lib-esm/utils/combineShortcuts.js","../../node_modules/react-kbs/lib-esm/utils/shouldIgnoreElement.js","../../node_modules/react-kbs/lib-esm/utils/getKeyDownHandler.js","../../node_modules/react-kbs/lib-esm/KbsProvider.js","../../node_modules/react-kbs/lib-esm/hooks/useKbsGlobal.js","../../src/context/contexts.ts","../../src/hooks/useRoiDispatch.ts","../../node_modules/@juggle/resize-observer/lib/utils/resizeObservers.js","../../node_modules/@juggle/resize-observer/lib/algorithms/hasActiveObservations.js","../../node_modules/@juggle/resize-observer/lib/algorithms/hasSkippedObservations.js","../../node_modules/@juggle/resize-observer/lib/algorithms/deliverResizeLoopError.js","../../node_modules/@juggle/resize-observer/lib/ResizeObserverBoxOptions.js","../../node_modules/@juggle/resize-observer/lib/utils/freeze.js","../../node_modules/@juggle/resize-observer/lib/ResizeObserverSize.js","../../node_modules/@juggle/resize-observer/lib/DOMRectReadOnly.js","../../node_modules/@juggle/resize-observer/lib/utils/element.js","../../node_modules/@juggle/resize-observer/lib/utils/global.js","../../node_modules/@juggle/resize-observer/lib/algorithms/calculateBoxSize.js","../../node_modules/@juggle/resize-observer/lib/ResizeObserverEntry.js","../../node_modules/@juggle/resize-observer/lib/algorithms/calculateDepthForNode.js","../../node_modules/@juggle/resize-observer/lib/algorithms/broadcastActiveObservations.js","../../node_modules/@juggle/resize-observer/lib/algorithms/gatherActiveObservationsAtDepth.js","../../node_modules/@juggle/resize-observer/lib/utils/process.js","../../node_modules/@juggle/resize-observer/lib/utils/queueMicroTask.js","../../node_modules/@juggle/resize-observer/lib/utils/queueResizeObserver.js","../../node_modules/@juggle/resize-observer/lib/utils/scheduler.js","../../node_modules/@juggle/resize-observer/lib/ResizeObservation.js","../../node_modules/@juggle/resize-observer/lib/ResizeObserverDetail.js","../../node_modules/@juggle/resize-observer/lib/ResizeObserverController.js","../../node_modules/@juggle/resize-observer/lib/ResizeObserver.js","../../node_modules/@react-hook/passive-layout-effect/dist/module/index.js","../../node_modules/@react-hook/latest/dist/module/index.js","../../node_modules/@react-hook/resize-observer/dist/module/index.js","../../src/hooks/useRoiState.ts","../../src/hooks/useRois.ts","../../src/hooks/usePanZoom.ts","../../src/utilities/throttle.ts","../../src/components/ContainerComponent.tsx","../../src/components/api/RoiContainer.tsx","../../src/utilities/assert.ts","../../src/utilities/corners.ts","../../src/components/Box.tsx","../../src/components/RoiBoxCorner.tsx","../../src/components/api/RoiBox.tsx","../../src/components/api/RoiList.tsx","../../src/utilities/coordinates.ts","../../src/utilities/rois.ts","../../node_modules/immer/dist/immer.mjs","../../src/context/updaters/cancelAction.ts","../../src/context/updaters/roi.ts","../../src/context/updaters/endAction.ts","../../src/context/updaters/mouseMove.ts","../../src/utilities/panZoom.ts","../../src/context/updaters/startDraw.ts","../../src/context/updaters/zoom.ts","../../src/context/roiReducer.tsx","../../src/context/RoiProvider.tsx"],"sourcesContent":["const defaultModifiers = {\n    ctrl: false,\n    shift: undefined,\n    alt: false,\n};\nexport function cleanShortcuts(inputs) {\n    const result = [];\n    for (const input of inputs) {\n        for (const definition of input) {\n            const [main, ...aliases] = shortcutToObjects(definition.shortcut);\n            result.push({\n                shortcut: main,\n                aliases,\n                handler: definition.handler,\n                meta: definition.meta,\n                maxFrequency: definition.maxFrequency ?? 0,\n            });\n        }\n    }\n    return result;\n}\nfunction shortcutToObjects(shortcut) {\n    if (typeof shortcut === 'string') {\n        return [{ ...defaultModifiers, key: shortcut.toLowerCase() }];\n    }\n    else if (Array.isArray(shortcut)) {\n        return shortcut.map((shortcut) => {\n            if (typeof shortcut === 'string') {\n                return { ...defaultModifiers, key: shortcut.toLowerCase() };\n            }\n            else if ('key' in shortcut) {\n                return {\n                    ...defaultModifiers,\n                    ...shortcut,\n                    key: shortcut.key.toLowerCase(),\n                };\n            }\n            else {\n                return {\n                    ...defaultModifiers,\n                    ...shortcut,\n                    code: shortcut.code.toLowerCase(),\n                };\n            }\n        });\n    }\n    else if ('key' in shortcut) {\n        return [\n            { ...defaultModifiers, ...shortcut, key: shortcut.key.toLowerCase() },\n        ];\n    }\n    else {\n        return [\n            { ...defaultModifiers, ...shortcut, code: shortcut.code.toLowerCase() },\n        ];\n    }\n}\n","const isMac = typeof navigator !== 'undefined' && navigator.platform === 'MacIntel';\nexport function isMultiplatformCtrlKey(event) {\n    return isMac ? event.metaKey : event.ctrlKey;\n}\n","import { isMultiplatformCtrlKey } from './macInterop';\nexport function shortcutToKeys(shortcut) {\n    return [\n        ...shortcutObjectToKey(shortcut.shortcut),\n        ...shortcut.aliases.map(shortcutObjectToKey).flat(),\n    ];\n}\nexport function shortcutObjectToKey(shortcut) {\n    const modifiers = `ctrl[${boolToString(shortcut.ctrl)}]_alt[${boolToString(shortcut.alt)}]`;\n    let prefix;\n    if ('key' in shortcut) {\n        prefix = `key[${shortcut.key}]_${modifiers}`;\n    }\n    else {\n        prefix = `code[${shortcut.code}]_${modifiers}`;\n    }\n    if (typeof shortcut.shift === 'boolean') {\n        return [`${prefix}_shift[${boolToString(shortcut.shift)}]`];\n    }\n    else {\n        // If `shift` is not specified, allow it regardless of its state during the\n        // event. This is to support any keyboard layout.\n        return [`${prefix}_shift[true]`, `${prefix}_shift[false]`];\n    }\n}\nexport function eventToKeyOrCode(event) {\n    const modifiers = `ctrl[${boolToString(isMultiplatformCtrlKey(event))}]_alt[${boolToString(event.altKey)}]_shift[${boolToString(event.shiftKey)}]`;\n    return {\n        key: `key[${event.key.toLowerCase()}]_${modifiers}`,\n        code: `code[${event.code.toLowerCase()}]_${modifiers}`,\n    };\n}\nfunction boolToString(bool) {\n    return bool ? 'true' : 'false';\n}\n","import { shortcutToKeys } from './makeKey';\nexport function combineShortcuts(shortcuts) {\n    const result = {};\n    for (const shortcut of shortcuts) {\n        const keys = shortcutToKeys(shortcut);\n        for (const key of keys) {\n            if (result[key] !== undefined) {\n                // eslint-disable-next-line no-console\n                console.warn(`A global shortcut was already defined for key the combination ${key}. It will be overridden.`);\n            }\n            result[key] = shortcut;\n        }\n    }\n    return result;\n}\n","const inputElements = new Set(['INPUT', 'TEXTAREA', 'SELECT']);\nexport function shouldIgnoreElement(element) {\n    return (inputElements.has(element.tagName) ||\n        element.isContentEditable ||\n        element.hasAttribute('data-kbs-ignore'));\n}\n","import { useRef, } from 'react';\nimport { eventToKeyOrCode } from './makeKey';\nimport { shouldIgnoreElement } from './shouldIgnoreElement';\nexport function useLastTriggerRef() {\n    return useRef({ keyOrCode: '', timestamp: 0 });\n}\nexport function getKeyDownHandler(lastTrigger, combinedShortcuts) {\n    return function handleKeyDown(event) {\n        if (shouldIgnoreElement(event.target)) {\n            return;\n        }\n        const { key, code } = eventToKeyOrCode(event);\n        let keyOrCode;\n        let shortcut;\n        if (combinedShortcuts[key]) {\n            shortcut = combinedShortcuts[key];\n            keyOrCode = key;\n        }\n        else {\n            shortcut = combinedShortcuts[code];\n            keyOrCode = code;\n        }\n        if (shortcut) {\n            event.stopPropagation();\n            event.preventDefault();\n            if (shortcut.maxFrequency > 0) {\n                const now = performance.now();\n                if (event.repeat &&\n                    lastTrigger.current.keyOrCode === keyOrCode &&\n                    now - lastTrigger.current.timestamp < 1000 / shortcut.maxFrequency) {\n                    return;\n                }\n                lastTrigger.current = { keyOrCode, timestamp: now };\n            }\n            shortcut.handler(event);\n        }\n    };\n}\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { createContext, useContext, useReducer, useEffect, } from 'react';\nimport { cleanShortcuts } from './utils/cleanShortcuts';\nimport { combineShortcuts } from './utils/combineShortcuts';\nimport { getKeyDownHandler, useLastTriggerRef, } from './utils/getKeyDownHandler';\nconst initialKbsState = {\n    inputShortcuts: [],\n    cleanedShortcuts: [],\n    combinedShortcuts: {},\n    disableCount: 0,\n};\nexport const kbsContext = createContext(initialKbsState);\nconst kbsDispatchContext = createContext(null);\nexport function useKbsUncheckedDispatch() {\n    return useContext(kbsDispatchContext);\n}\nexport function useKbsDispatch() {\n    const dispatch = useContext(kbsDispatchContext);\n    if (!dispatch) {\n        throw new Error('missing context');\n    }\n    return dispatch;\n}\nfunction kbsReducer(state, action) {\n    switch (action.type) {\n        case 'INIT': {\n            const newInputs = [...state.inputShortcuts, action.shortcuts];\n            const cleanedShortcuts = cleanShortcuts(newInputs);\n            return {\n                ...state,\n                inputShortcuts: newInputs,\n                cleanedShortcuts,\n                combinedShortcuts: combineShortcuts(cleanedShortcuts),\n            };\n        }\n        case 'CLEANUP': {\n            const newInputs = state.inputShortcuts.filter((shortcuts) => shortcuts !== action.shortcuts);\n            const cleanedShortcuts = cleanShortcuts(newInputs);\n            return {\n                ...state,\n                inputShortcuts: newInputs,\n                cleanedShortcuts,\n                combinedShortcuts: combineShortcuts(cleanedShortcuts),\n            };\n        }\n        case 'DISABLE_GLOBAL': {\n            return { ...state, disableCount: state.disableCount + 1 };\n        }\n        case 'ENABLE_GLOBAL': {\n            return { ...state, disableCount: state.disableCount - 1 };\n        }\n        default:\n            throw new Error('unreachable');\n    }\n}\nexport function KbsProvider(props) {\n    const [kbsState, kbsDispatch] = useReducer(kbsReducer, initialKbsState);\n    const lastTrigger = useLastTriggerRef();\n    useEffect(() => {\n        if (kbsState.disableCount !== 0)\n            return;\n        const handleKeyDown = getKeyDownHandler(lastTrigger, kbsState.combinedShortcuts);\n        document.body.addEventListener('keydown', handleKeyDown);\n        return () => document.body.removeEventListener('keydown', handleKeyDown);\n    }, [kbsState.disableCount, kbsState.combinedShortcuts, lastTrigger]);\n    return (_jsx(kbsContext.Provider, { value: kbsState, children: _jsx(kbsDispatchContext.Provider, { value: kbsDispatch, children: props.children }) }));\n}\n","import { useEffect } from 'react';\nimport { useKbsDispatch } from '../KbsProvider';\nexport function useKbsGlobal(shortcuts) {\n    const kbsDispatch = useKbsDispatch();\n    useEffect(() => {\n        kbsDispatch({ type: 'INIT', shortcuts });\n        return () => kbsDispatch({ type: 'CLEANUP', shortcuts });\n    }, [kbsDispatch, shortcuts]);\n}\n","import { Dispatch, MutableRefObject, createContext } from 'react';\n\nimport { CommittedRoi, Roi } from '../types/Roi';\n\nimport type { ReactRoiState, RoiReducerAction } from './roiReducer';\n\nexport const roiStateContext = createContext<Pick<\n  ReactRoiState,\n  'mode' | 'selectedRoi'\n> | null>(null);\n\nexport const roiDispatchContext =\n  createContext<Dispatch<RoiReducerAction> | null>(null);\n\nexport const committedRoisContext = createContext<CommittedRoi[] | null>(null);\n\nexport const roisContext = createContext<Roi[] | null>(null);\n\nexport const roiContainerRefContext =\n  createContext<MutableRefObject<HTMLDivElement> | null>(null);\n\nexport interface PanZoomContext {\n  scale: number;\n  translation: [number, number];\n}\nexport const panZoomContext = createContext<PanZoomContext>({\n  scale: 1.5,\n  translation: [0, 0],\n});\n","import { useContext } from 'react';\n\nimport { roiDispatchContext } from '../context/contexts';\n\nexport function useRoiDispatch() {\n  const roiDispatch = useContext(roiDispatchContext);\n  if (!roiDispatch) {\n    throw new Error(\n      'roiDispatchContext is not defined, please check if you are using RoiProvider',\n    );\n  }\n  return roiDispatch;\n}\n","var resizeObservers = [];\nexport { resizeObservers };\n","import { resizeObservers } from '../utils/resizeObservers';\nvar hasActiveObservations = function () {\n    return resizeObservers.some(function (ro) { return ro.activeTargets.length > 0; });\n};\nexport { hasActiveObservations };\n","import { resizeObservers } from '../utils/resizeObservers';\nvar hasSkippedObservations = function () {\n    return resizeObservers.some(function (ro) { return ro.skippedTargets.length > 0; });\n};\nexport { hasSkippedObservations };\n","var msg = 'ResizeObserver loop completed with undelivered notifications.';\nvar deliverResizeLoopError = function () {\n    var event;\n    if (typeof ErrorEvent === 'function') {\n        event = new ErrorEvent('error', {\n            message: msg\n        });\n    }\n    else {\n        event = document.createEvent('Event');\n        event.initEvent('error', false, false);\n        event.message = msg;\n    }\n    window.dispatchEvent(event);\n};\nexport { deliverResizeLoopError };\n","var ResizeObserverBoxOptions;\n(function (ResizeObserverBoxOptions) {\n    ResizeObserverBoxOptions[\"BORDER_BOX\"] = \"border-box\";\n    ResizeObserverBoxOptions[\"CONTENT_BOX\"] = \"content-box\";\n    ResizeObserverBoxOptions[\"DEVICE_PIXEL_CONTENT_BOX\"] = \"device-pixel-content-box\";\n})(ResizeObserverBoxOptions || (ResizeObserverBoxOptions = {}));\nexport { ResizeObserverBoxOptions };\n","export var freeze = function (obj) { return Object.freeze(obj); };\n","import { freeze } from './utils/freeze';\nvar ResizeObserverSize = (function () {\n    function ResizeObserverSize(inlineSize, blockSize) {\n        this.inlineSize = inlineSize;\n        this.blockSize = blockSize;\n        freeze(this);\n    }\n    return ResizeObserverSize;\n}());\nexport { ResizeObserverSize };\n","import { freeze } from './utils/freeze';\nvar DOMRectReadOnly = (function () {\n    function DOMRectReadOnly(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        this.top = this.y;\n        this.left = this.x;\n        this.bottom = this.top + this.height;\n        this.right = this.left + this.width;\n        return freeze(this);\n    }\n    DOMRectReadOnly.prototype.toJSON = function () {\n        var _a = this, x = _a.x, y = _a.y, top = _a.top, right = _a.right, bottom = _a.bottom, left = _a.left, width = _a.width, height = _a.height;\n        return { x: x, y: y, top: top, right: right, bottom: bottom, left: left, width: width, height: height };\n    };\n    DOMRectReadOnly.fromRect = function (rectangle) {\n        return new DOMRectReadOnly(rectangle.x, rectangle.y, rectangle.width, rectangle.height);\n    };\n    return DOMRectReadOnly;\n}());\nexport { DOMRectReadOnly };\n","var isSVG = function (target) { return target instanceof SVGElement && 'getBBox' in target; };\nvar isHidden = function (target) {\n    if (isSVG(target)) {\n        var _a = target.getBBox(), width = _a.width, height = _a.height;\n        return !width && !height;\n    }\n    var _b = target, offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight;\n    return !(offsetWidth || offsetHeight || target.getClientRects().length);\n};\nvar isElement = function (obj) {\n    var _a;\n    if (obj instanceof Element) {\n        return true;\n    }\n    var scope = (_a = obj === null || obj === void 0 ? void 0 : obj.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView;\n    return !!(scope && obj instanceof scope.Element);\n};\nvar isReplacedElement = function (target) {\n    switch (target.tagName) {\n        case 'INPUT':\n            if (target.type !== 'image') {\n                break;\n            }\n        case 'VIDEO':\n        case 'AUDIO':\n        case 'EMBED':\n        case 'OBJECT':\n        case 'CANVAS':\n        case 'IFRAME':\n        case 'IMG':\n            return true;\n    }\n    return false;\n};\nexport { isSVG, isHidden, isElement, isReplacedElement };\n","export var global = typeof window !== 'undefined' ? window : {};\n","import { ResizeObserverBoxOptions } from '../ResizeObserverBoxOptions';\nimport { ResizeObserverSize } from '../ResizeObserverSize';\nimport { DOMRectReadOnly } from '../DOMRectReadOnly';\nimport { isSVG, isHidden } from '../utils/element';\nimport { freeze } from '../utils/freeze';\nimport { global } from '../utils/global';\nvar cache = new WeakMap();\nvar scrollRegexp = /auto|scroll/;\nvar verticalRegexp = /^tb|vertical/;\nvar IE = (/msie|trident/i).test(global.navigator && global.navigator.userAgent);\nvar parseDimension = function (pixel) { return parseFloat(pixel || '0'); };\nvar size = function (inlineSize, blockSize, switchSizes) {\n    if (inlineSize === void 0) { inlineSize = 0; }\n    if (blockSize === void 0) { blockSize = 0; }\n    if (switchSizes === void 0) { switchSizes = false; }\n    return new ResizeObserverSize((switchSizes ? blockSize : inlineSize) || 0, (switchSizes ? inlineSize : blockSize) || 0);\n};\nvar zeroBoxes = freeze({\n    devicePixelContentBoxSize: size(),\n    borderBoxSize: size(),\n    contentBoxSize: size(),\n    contentRect: new DOMRectReadOnly(0, 0, 0, 0)\n});\nvar calculateBoxSizes = function (target, forceRecalculation) {\n    if (forceRecalculation === void 0) { forceRecalculation = false; }\n    if (cache.has(target) && !forceRecalculation) {\n        return cache.get(target);\n    }\n    if (isHidden(target)) {\n        cache.set(target, zeroBoxes);\n        return zeroBoxes;\n    }\n    var cs = getComputedStyle(target);\n    var svg = isSVG(target) && target.ownerSVGElement && target.getBBox();\n    var removePadding = !IE && cs.boxSizing === 'border-box';\n    var switchSizes = verticalRegexp.test(cs.writingMode || '');\n    var canScrollVertically = !svg && scrollRegexp.test(cs.overflowY || '');\n    var canScrollHorizontally = !svg && scrollRegexp.test(cs.overflowX || '');\n    var paddingTop = svg ? 0 : parseDimension(cs.paddingTop);\n    var paddingRight = svg ? 0 : parseDimension(cs.paddingRight);\n    var paddingBottom = svg ? 0 : parseDimension(cs.paddingBottom);\n    var paddingLeft = svg ? 0 : parseDimension(cs.paddingLeft);\n    var borderTop = svg ? 0 : parseDimension(cs.borderTopWidth);\n    var borderRight = svg ? 0 : parseDimension(cs.borderRightWidth);\n    var borderBottom = svg ? 0 : parseDimension(cs.borderBottomWidth);\n    var borderLeft = svg ? 0 : parseDimension(cs.borderLeftWidth);\n    var horizontalPadding = paddingLeft + paddingRight;\n    var verticalPadding = paddingTop + paddingBottom;\n    var horizontalBorderArea = borderLeft + borderRight;\n    var verticalBorderArea = borderTop + borderBottom;\n    var horizontalScrollbarThickness = !canScrollHorizontally ? 0 : target.offsetHeight - verticalBorderArea - target.clientHeight;\n    var verticalScrollbarThickness = !canScrollVertically ? 0 : target.offsetWidth - horizontalBorderArea - target.clientWidth;\n    var widthReduction = removePadding ? horizontalPadding + horizontalBorderArea : 0;\n    var heightReduction = removePadding ? verticalPadding + verticalBorderArea : 0;\n    var contentWidth = svg ? svg.width : parseDimension(cs.width) - widthReduction - verticalScrollbarThickness;\n    var contentHeight = svg ? svg.height : parseDimension(cs.height) - heightReduction - horizontalScrollbarThickness;\n    var borderBoxWidth = contentWidth + horizontalPadding + verticalScrollbarThickness + horizontalBorderArea;\n    var borderBoxHeight = contentHeight + verticalPadding + horizontalScrollbarThickness + verticalBorderArea;\n    var boxes = freeze({\n        devicePixelContentBoxSize: size(Math.round(contentWidth * devicePixelRatio), Math.round(contentHeight * devicePixelRatio), switchSizes),\n        borderBoxSize: size(borderBoxWidth, borderBoxHeight, switchSizes),\n        contentBoxSize: size(contentWidth, contentHeight, switchSizes),\n        contentRect: new DOMRectReadOnly(paddingLeft, paddingTop, contentWidth, contentHeight)\n    });\n    cache.set(target, boxes);\n    return boxes;\n};\nvar calculateBoxSize = function (target, observedBox, forceRecalculation) {\n    var _a = calculateBoxSizes(target, forceRecalculation), borderBoxSize = _a.borderBoxSize, contentBoxSize = _a.contentBoxSize, devicePixelContentBoxSize = _a.devicePixelContentBoxSize;\n    switch (observedBox) {\n        case ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX:\n            return devicePixelContentBoxSize;\n        case ResizeObserverBoxOptions.BORDER_BOX:\n            return borderBoxSize;\n        default:\n            return contentBoxSize;\n    }\n};\nexport { calculateBoxSize, calculateBoxSizes };\n","import { calculateBoxSizes } from './algorithms/calculateBoxSize';\nimport { freeze } from './utils/freeze';\nvar ResizeObserverEntry = (function () {\n    function ResizeObserverEntry(target) {\n        var boxes = calculateBoxSizes(target);\n        this.target = target;\n        this.contentRect = boxes.contentRect;\n        this.borderBoxSize = freeze([boxes.borderBoxSize]);\n        this.contentBoxSize = freeze([boxes.contentBoxSize]);\n        this.devicePixelContentBoxSize = freeze([boxes.devicePixelContentBoxSize]);\n    }\n    return ResizeObserverEntry;\n}());\nexport { ResizeObserverEntry };\n","import { isHidden } from '../utils/element';\nvar calculateDepthForNode = function (node) {\n    if (isHidden(node)) {\n        return Infinity;\n    }\n    var depth = 0;\n    var parent = node.parentNode;\n    while (parent) {\n        depth += 1;\n        parent = parent.parentNode;\n    }\n    return depth;\n};\nexport { calculateDepthForNode };\n","import { resizeObservers } from '../utils/resizeObservers';\nimport { ResizeObserverEntry } from '../ResizeObserverEntry';\nimport { calculateDepthForNode } from './calculateDepthForNode';\nimport { calculateBoxSize } from './calculateBoxSize';\nvar broadcastActiveObservations = function () {\n    var shallowestDepth = Infinity;\n    var callbacks = [];\n    resizeObservers.forEach(function processObserver(ro) {\n        if (ro.activeTargets.length === 0) {\n            return;\n        }\n        var entries = [];\n        ro.activeTargets.forEach(function processTarget(ot) {\n            var entry = new ResizeObserverEntry(ot.target);\n            var targetDepth = calculateDepthForNode(ot.target);\n            entries.push(entry);\n            ot.lastReportedSize = calculateBoxSize(ot.target, ot.observedBox);\n            if (targetDepth < shallowestDepth) {\n                shallowestDepth = targetDepth;\n            }\n        });\n        callbacks.push(function resizeObserverCallback() {\n            ro.callback.call(ro.observer, entries, ro.observer);\n        });\n        ro.activeTargets.splice(0, ro.activeTargets.length);\n    });\n    for (var _i = 0, callbacks_1 = callbacks; _i < callbacks_1.length; _i++) {\n        var callback = callbacks_1[_i];\n        callback();\n    }\n    return shallowestDepth;\n};\nexport { broadcastActiveObservations };\n","import { resizeObservers } from '../utils/resizeObservers';\nimport { calculateDepthForNode } from './calculateDepthForNode';\nvar gatherActiveObservationsAtDepth = function (depth) {\n    resizeObservers.forEach(function processObserver(ro) {\n        ro.activeTargets.splice(0, ro.activeTargets.length);\n        ro.skippedTargets.splice(0, ro.skippedTargets.length);\n        ro.observationTargets.forEach(function processTarget(ot) {\n            if (ot.isActive()) {\n                if (calculateDepthForNode(ot.target) > depth) {\n                    ro.activeTargets.push(ot);\n                }\n                else {\n                    ro.skippedTargets.push(ot);\n                }\n            }\n        });\n    });\n};\nexport { gatherActiveObservationsAtDepth };\n","import { hasActiveObservations } from '../algorithms/hasActiveObservations';\nimport { hasSkippedObservations } from '../algorithms/hasSkippedObservations';\nimport { deliverResizeLoopError } from '../algorithms/deliverResizeLoopError';\nimport { broadcastActiveObservations } from '../algorithms/broadcastActiveObservations';\nimport { gatherActiveObservationsAtDepth } from '../algorithms/gatherActiveObservationsAtDepth';\nvar process = function () {\n    var depth = 0;\n    gatherActiveObservationsAtDepth(depth);\n    while (hasActiveObservations()) {\n        depth = broadcastActiveObservations();\n        gatherActiveObservationsAtDepth(depth);\n    }\n    if (hasSkippedObservations()) {\n        deliverResizeLoopError();\n    }\n    return depth > 0;\n};\nexport { process };\n","var trigger;\nvar callbacks = [];\nvar notify = function () { return callbacks.splice(0).forEach(function (cb) { return cb(); }); };\nvar queueMicroTask = function (callback) {\n    if (!trigger) {\n        var toggle_1 = 0;\n        var el_1 = document.createTextNode('');\n        var config = { characterData: true };\n        new MutationObserver(function () { return notify(); }).observe(el_1, config);\n        trigger = function () { el_1.textContent = \"\".concat(toggle_1 ? toggle_1-- : toggle_1++); };\n    }\n    callbacks.push(callback);\n    trigger();\n};\nexport { queueMicroTask };\n","import { queueMicroTask } from './queueMicroTask';\nvar queueResizeObserver = function (cb) {\n    queueMicroTask(function ResizeObserver() {\n        requestAnimationFrame(cb);\n    });\n};\nexport { queueResizeObserver };\n","import { process } from './process';\nimport { global } from './global';\nimport { queueResizeObserver } from './queueResizeObserver';\nvar watching = 0;\nvar isWatching = function () { return !!watching; };\nvar CATCH_PERIOD = 250;\nvar observerConfig = { attributes: true, characterData: true, childList: true, subtree: true };\nvar events = [\n    'resize',\n    'load',\n    'transitionend',\n    'animationend',\n    'animationstart',\n    'animationiteration',\n    'keyup',\n    'keydown',\n    'mouseup',\n    'mousedown',\n    'mouseover',\n    'mouseout',\n    'blur',\n    'focus'\n];\nvar time = function (timeout) {\n    if (timeout === void 0) { timeout = 0; }\n    return Date.now() + timeout;\n};\nvar scheduled = false;\nvar Scheduler = (function () {\n    function Scheduler() {\n        var _this = this;\n        this.stopped = true;\n        this.listener = function () { return _this.schedule(); };\n    }\n    Scheduler.prototype.run = function (timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = CATCH_PERIOD; }\n        if (scheduled) {\n            return;\n        }\n        scheduled = true;\n        var until = time(timeout);\n        queueResizeObserver(function () {\n            var elementsHaveResized = false;\n            try {\n                elementsHaveResized = process();\n            }\n            finally {\n                scheduled = false;\n                timeout = until - time();\n                if (!isWatching()) {\n                    return;\n                }\n                if (elementsHaveResized) {\n                    _this.run(1000);\n                }\n                else if (timeout > 0) {\n                    _this.run(timeout);\n                }\n                else {\n                    _this.start();\n                }\n            }\n        });\n    };\n    Scheduler.prototype.schedule = function () {\n        this.stop();\n        this.run();\n    };\n    Scheduler.prototype.observe = function () {\n        var _this = this;\n        var cb = function () { return _this.observer && _this.observer.observe(document.body, observerConfig); };\n        document.body ? cb() : global.addEventListener('DOMContentLoaded', cb);\n    };\n    Scheduler.prototype.start = function () {\n        var _this = this;\n        if (this.stopped) {\n            this.stopped = false;\n            this.observer = new MutationObserver(this.listener);\n            this.observe();\n            events.forEach(function (name) { return global.addEventListener(name, _this.listener, true); });\n        }\n    };\n    Scheduler.prototype.stop = function () {\n        var _this = this;\n        if (!this.stopped) {\n            this.observer && this.observer.disconnect();\n            events.forEach(function (name) { return global.removeEventListener(name, _this.listener, true); });\n            this.stopped = true;\n        }\n    };\n    return Scheduler;\n}());\nvar scheduler = new Scheduler();\nvar updateCount = function (n) {\n    !watching && n > 0 && scheduler.start();\n    watching += n;\n    !watching && scheduler.stop();\n};\nexport { scheduler, updateCount };\n","import { ResizeObserverBoxOptions } from './ResizeObserverBoxOptions';\nimport { calculateBoxSize } from './algorithms/calculateBoxSize';\nimport { isSVG, isReplacedElement } from './utils/element';\nvar skipNotifyOnElement = function (target) {\n    return !isSVG(target)\n        && !isReplacedElement(target)\n        && getComputedStyle(target).display === 'inline';\n};\nvar ResizeObservation = (function () {\n    function ResizeObservation(target, observedBox) {\n        this.target = target;\n        this.observedBox = observedBox || ResizeObserverBoxOptions.CONTENT_BOX;\n        this.lastReportedSize = {\n            inlineSize: 0,\n            blockSize: 0\n        };\n    }\n    ResizeObservation.prototype.isActive = function () {\n        var size = calculateBoxSize(this.target, this.observedBox, true);\n        if (skipNotifyOnElement(this.target)) {\n            this.lastReportedSize = size;\n        }\n        if (this.lastReportedSize.inlineSize !== size.inlineSize\n            || this.lastReportedSize.blockSize !== size.blockSize) {\n            return true;\n        }\n        return false;\n    };\n    return ResizeObservation;\n}());\nexport { ResizeObservation };\n","var ResizeObserverDetail = (function () {\n    function ResizeObserverDetail(resizeObserver, callback) {\n        this.activeTargets = [];\n        this.skippedTargets = [];\n        this.observationTargets = [];\n        this.observer = resizeObserver;\n        this.callback = callback;\n    }\n    return ResizeObserverDetail;\n}());\nexport { ResizeObserverDetail };\n","import { scheduler, updateCount } from './utils/scheduler';\nimport { ResizeObservation } from './ResizeObservation';\nimport { ResizeObserverDetail } from './ResizeObserverDetail';\nimport { resizeObservers } from './utils/resizeObservers';\nvar observerMap = new WeakMap();\nvar getObservationIndex = function (observationTargets, target) {\n    for (var i = 0; i < observationTargets.length; i += 1) {\n        if (observationTargets[i].target === target) {\n            return i;\n        }\n    }\n    return -1;\n};\nvar ResizeObserverController = (function () {\n    function ResizeObserverController() {\n    }\n    ResizeObserverController.connect = function (resizeObserver, callback) {\n        var detail = new ResizeObserverDetail(resizeObserver, callback);\n        observerMap.set(resizeObserver, detail);\n    };\n    ResizeObserverController.observe = function (resizeObserver, target, options) {\n        var detail = observerMap.get(resizeObserver);\n        var firstObservation = detail.observationTargets.length === 0;\n        if (getObservationIndex(detail.observationTargets, target) < 0) {\n            firstObservation && resizeObservers.push(detail);\n            detail.observationTargets.push(new ResizeObservation(target, options && options.box));\n            updateCount(1);\n            scheduler.schedule();\n        }\n    };\n    ResizeObserverController.unobserve = function (resizeObserver, target) {\n        var detail = observerMap.get(resizeObserver);\n        var index = getObservationIndex(detail.observationTargets, target);\n        var lastObservation = detail.observationTargets.length === 1;\n        if (index >= 0) {\n            lastObservation && resizeObservers.splice(resizeObservers.indexOf(detail), 1);\n            detail.observationTargets.splice(index, 1);\n            updateCount(-1);\n        }\n    };\n    ResizeObserverController.disconnect = function (resizeObserver) {\n        var _this = this;\n        var detail = observerMap.get(resizeObserver);\n        detail.observationTargets.slice().forEach(function (ot) { return _this.unobserve(resizeObserver, ot.target); });\n        detail.activeTargets.splice(0, detail.activeTargets.length);\n    };\n    return ResizeObserverController;\n}());\nexport { ResizeObserverController };\n","import { ResizeObserverController } from './ResizeObserverController';\nimport { isElement } from './utils/element';\nvar ResizeObserver = (function () {\n    function ResizeObserver(callback) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (typeof callback !== 'function') {\n            throw new TypeError(\"Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.\");\n        }\n        ResizeObserverController.connect(this, callback);\n    }\n    ResizeObserver.prototype.observe = function (target, options) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (!isElement(target)) {\n            throw new TypeError(\"Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element\");\n        }\n        ResizeObserverController.observe(this, target, options);\n    };\n    ResizeObserver.prototype.unobserve = function (target) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (!isElement(target)) {\n            throw new TypeError(\"Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element\");\n        }\n        ResizeObserverController.unobserve(this, target);\n    };\n    ResizeObserver.prototype.disconnect = function () {\n        ResizeObserverController.disconnect(this);\n    };\n    ResizeObserver.toString = function () {\n        return 'function ResizeObserver () { [polyfill code] }';\n    };\n    return ResizeObserver;\n}());\nexport { ResizeObserver };\n","import React from 'react';\nconst usePassiveLayoutEffect = React[typeof document !== 'undefined' && document.createElement !== void 0 ? 'useLayoutEffect' : 'useEffect'];\nexport default usePassiveLayoutEffect;","import * as React from 'react';\n\nconst useLatest = current => {\n  const storedValue = React.useRef(current);\n  React.useEffect(() => {\n    storedValue.current = current;\n  });\n  return storedValue;\n};\n\nexport default useLatest;","/* eslint-disable no-return-assign */\n\n/* eslint-disable no-underscore-dangle */\nimport { ResizeObserver as Polyfill } from '@juggle/resize-observer';\nimport useLayoutEffect from '@react-hook/passive-layout-effect';\nimport useLatest from '@react-hook/latest';\nconst ResizeObserver = typeof window !== 'undefined' && 'ResizeObserver' in window ? // @ts-ignore\nwindow.ResizeObserver : Polyfill;\n/**\n * A React hook that fires a callback whenever ResizeObserver detects a change to its size\n *\n * @param target A React ref created by `useRef()` or an HTML element\n * @param callback Invoked with a single `ResizeObserverEntry` any time\n *   the `target` resizes\n */\n\nfunction _ref() {}\n\nfunction useResizeObserver(target, callback) {\n  const resizeObserver = getResizeObserver();\n  const storedCallback = useLatest(callback);\n  useLayoutEffect(() => {\n    let didUnsubscribe = false;\n    const targetEl = target && 'current' in target ? target.current : target;\n    if (!targetEl) return _ref;\n\n    function cb(entry, observer) {\n      if (didUnsubscribe) return;\n      storedCallback.current(entry, observer);\n    }\n\n    resizeObserver.subscribe(targetEl, cb);\n    return () => {\n      didUnsubscribe = true;\n      resizeObserver.unsubscribe(targetEl, cb);\n    };\n  }, [target, resizeObserver, storedCallback]);\n  return resizeObserver.observer;\n}\n\nfunction createResizeObserver() {\n  let ticking = false;\n  let allEntries = [];\n  const callbacks = new Map();\n  const observer = new ResizeObserver((entries, obs) => {\n    allEntries = allEntries.concat(entries);\n\n    function _ref2() {\n      const triggered = new Set();\n\n      for (let i = 0; i < allEntries.length; i++) {\n        if (triggered.has(allEntries[i].target)) continue;\n        triggered.add(allEntries[i].target);\n        const cbs = callbacks.get(allEntries[i].target);\n        cbs === null || cbs === void 0 ? void 0 : cbs.forEach(cb => cb(allEntries[i], obs));\n      }\n\n      allEntries = [];\n      ticking = false;\n    }\n\n    if (!ticking) {\n      window.requestAnimationFrame(_ref2);\n    }\n\n    ticking = true;\n  });\n  return {\n    observer,\n\n    subscribe(target, callback) {\n      var _callbacks$get;\n\n      observer.observe(target);\n      const cbs = (_callbacks$get = callbacks.get(target)) !== null && _callbacks$get !== void 0 ? _callbacks$get : [];\n      cbs.push(callback);\n      callbacks.set(target, cbs);\n    },\n\n    unsubscribe(target, callback) {\n      var _callbacks$get2;\n\n      const cbs = (_callbacks$get2 = callbacks.get(target)) !== null && _callbacks$get2 !== void 0 ? _callbacks$get2 : [];\n\n      if (cbs.length === 1) {\n        observer.unobserve(target);\n        callbacks.delete(target);\n        return;\n      }\n\n      const cbIndex = cbs.indexOf(callback);\n      if (cbIndex !== -1) cbs.splice(cbIndex, 1);\n      callbacks.set(target, cbs);\n    }\n\n  };\n}\n\nlet _resizeObserver;\n\nconst getResizeObserver = () => !_resizeObserver ? _resizeObserver = createResizeObserver() : _resizeObserver;\n\nexport default useResizeObserver;","import { useContext } from 'react';\n\nimport { roiStateContext } from '../context/contexts';\nimport { RoiContainerState } from '../types';\n\nexport function useRoiState() {\n  /**\n   * selected roi\n   * ratio\n   * mode\n   */\n  const state = useContext<RoiContainerState>(roiStateContext);\n  if (!state) {\n    throw new Error('useRoiState must be used within a RoiProvider');\n  }\n  return state;\n}\n","import { useContext } from 'react';\n\nimport { roisContext } from '../context/contexts';\nimport { Roi } from '../types/Roi';\n\nexport function useRois<T>() {\n  const rois = useContext(roisContext);\n  if (!rois) {\n    throw new Error('useRois must be used within a RoiProvider');\n  }\n  return rois as Array<Roi<T>>;\n}\n","import { useContext } from 'react';\n\nimport { panZoomContext } from '../context/contexts';\n\nexport function usePanZoom() {\n  return useContext(panZoomContext);\n}\n\nexport function usePanZoomTransform() {\n  const { scale, translation } = usePanZoom();\n  return `matrix(${scale}, 0, 0, ${scale}, ${translation[0]}, ${translation[1]})`;\n}\n","export function throttle(func, timeFrame) {\n  let lastTime = 0;\n  return function throttled(...args) {\n    const now = new Date().getTime();\n    if (now - lastTime >= timeFrame) {\n      func(...args);\n      lastTime = now;\n    }\n  };\n}\n","import useResizeObserver from '@react-hook/resize-observer';\nimport {\n  MutableRefObject,\n  WheelEvent,\n  useEffect,\n  useMemo,\n  useRef,\n} from 'react';\n\nimport { roiContainerRefContext } from '../context/contexts';\nimport { useRoiState } from '../hooks';\nimport { usePanZoomTransform } from '../hooks/usePanZoom';\nimport { useRoiDispatch } from '../hooks/useRoiDispatch';\nimport { throttle } from '../utilities/throttle';\n\ninterface ContainerProps {\n  target: JSX.Element & { ref?: MutableRefObject<HTMLImageElement> };\n  children: JSX.Element;\n  id?: string;\n}\n\nexport function ContainerComponent({ target, children, id }: ContainerProps) {\n  const roiDispatch = useRoiDispatch();\n  const roiState = useRoiState();\n  const panZoomTransform = usePanZoomTransform();\n  const ref = useRef<HTMLDivElement>(null);\n\n  const onWheel = useMemo(() => {\n    return throttle((event: WheelEvent) => {\n      if (!event.altKey) return;\n      event.stopPropagation();\n      roiDispatch({\n        type: 'ZOOM',\n        payload: {\n          scale: event.deltaY > 0 ? 0.92 : 1 / 0.92,\n          clientX: event.clientX,\n          clientY: event.clientY,\n          refBoundingClientRect: ref.current.getBoundingClientRect(),\n        },\n      });\n    }, 25);\n  }, [roiDispatch]);\n  useResizeObserver(ref, (entry) => {\n    roiDispatch({\n      type: 'SET_SIZE',\n      payload: {\n        width: entry.contentRect.width,\n        height: entry.contentRect.height,\n      },\n    });\n  });\n\n  useEffect(() => {\n    function onMouseMove(event: MouseEvent) {\n      roiDispatch({\n        type: 'MOUSE_MOVE',\n        payload: event,\n      });\n    }\n\n    function onMouseUp() {\n      roiDispatch({\n        type: 'END_ACTION',\n      });\n    }\n\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    return () => {\n      document.removeEventListener('mousemove', onMouseMove);\n      document.removeEventListener('mouseup', onMouseUp);\n    };\n  });\n\n  return (\n    <roiContainerRefContext.Provider value={ref}>\n      <div\n        id={id}\n        ref={ref}\n        style={{\n          position: 'relative',\n          overflow: 'hidden',\n          margin: 0,\n          padding: 0,\n          cursor: roiState.mode === 'draw' ? 'crosshair' : 'default',\n          userSelect: 'none',\n        }}\n        onDoubleClick={() => {\n          roiDispatch({ type: 'RESET_ZOOM' });\n        }}\n        onWheel={onWheel}\n        onMouseDown={(event) => {\n          const containerBoundingRect = ref.current.getBoundingClientRect();\n          roiDispatch({\n            type: 'START_DRAW',\n            payload: {\n              event,\n              containerBoundingRect,\n              isPanZooming: event.altKey,\n            },\n          });\n        }}\n      >\n        <div\n          style={{\n            transform: panZoomTransform,\n            transformOrigin: '0 0',\n          }}\n        >\n          {target}\n\n          <div\n            style={{\n              userSelect: 'none',\n              width: '100%',\n              height: '100%',\n              position: 'absolute',\n              margin: 0,\n              padding: 0,\n              top: 0,\n              left: 0,\n            }}\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    </roiContainerRefContext.Provider>\n  );\n}\n","import { useKbsGlobal } from 'react-kbs';\n\nimport { useRoiDispatch } from '../../hooks/useRoiDispatch';\nimport { ContainerComponent } from '../ContainerComponent';\n\ninterface RoiComponentProps {\n  target?: JSX.Element;\n  children?: JSX.Element;\n  id?: string;\n}\n\nexport function RoiContainer({ target, children, id }: RoiComponentProps) {\n  const roiDispatch = useRoiDispatch();\n  useKbsGlobal([\n    {\n      shortcut: ['delete', 'backspace'],\n      handler: (event) => {\n        if (event.isTrusted) {\n          roiDispatch({ type: 'REMOVE_ROI', payload: undefined });\n        }\n      },\n    },\n    {\n      shortcut: ['Escape'],\n      handler: (event) => {\n        event.preventDefault();\n        if (event.isTrusted) {\n          roiDispatch({\n            type: 'CANCEL_ACTION',\n            payload: event as React.KeyboardEvent,\n          });\n        }\n      },\n    },\n  ]);\n  return (\n    <ContainerComponent id={id} target={target}>\n      {children}\n    </ContainerComponent>\n  );\n}\n","export function assertUnreachable(x: never, message?: string): never {\n  throw new Error(\n    `unreachable: ${\n      message\n        ? message\n        : typeof x === 'string'\n        ? x\n        : 'reached assertUnreachable'\n    }`,\n  );\n}\n\nexport function assertNotNull<T>(\n  value: T | null,\n): asserts value is Exclude<T, null> {\n  if (value === null) {\n    throw new Error('unexpected null value');\n  }\n}\n\nexport function assert(value: unknown, message?: string): asserts value {\n  if (!value) {\n    throw new Error(`unreachable${message ? `: ${message}` : ''}`);\n  }\n}\n","import { CSSProperties } from 'react';\n\nimport { Point } from '../types';\nimport { Roi } from '../types/Roi';\n\nimport { assertUnreachable } from './assert';\nimport { XCornerPosition, YCornerPosition } from './coordinates';\n\nexport interface CornerData {\n  xPosition: XCornerPosition;\n  yPosition: YCornerPosition;\n  cursor: CSSProperties['cursor'];\n  cx: number;\n  cy: number;\n}\n\nexport function getAllCorners(roi: Roi): CornerData[] {\n  const { x, y, width, height } = roi;\n  return [\n    {\n      xPosition: 'left',\n      yPosition: 'top',\n      cursor: 'nwse-resize',\n      cx: x,\n      cy: y,\n    },\n    {\n      xPosition: 'left',\n      yPosition: 'bottom',\n      cursor: 'nesw-resize',\n      cx: x,\n      cy: y + height,\n    },\n    {\n      xPosition: 'right',\n      yPosition: 'bottom',\n      cursor: 'nwse-resize',\n      cx: x + width,\n      cy: y + height,\n    },\n    {\n      cursor: 'nesw-resize',\n      xPosition: 'right',\n      yPosition: 'top',\n      cx: x + width,\n      cy: y,\n    },\n    {\n      xPosition: 'middle',\n      yPosition: 'top',\n      cursor: 'ns-resize',\n      cx: x + width / 2,\n      cy: y,\n    },\n    {\n      xPosition: 'middle',\n      yPosition: 'bottom',\n      cursor: 'ns-resize',\n      cx: x + width / 2,\n      cy: y + height,\n    },\n    {\n      xPosition: 'left',\n      yPosition: 'middle',\n      cursor: 'ew-resize',\n      cx: x,\n      cy: y + height / 2,\n    },\n    {\n      xPosition: 'right',\n      yPosition: 'middle',\n      cursor: 'ew-resize',\n      cx: x + width,\n      cy: y + height / 2,\n    },\n  ];\n}\n\nexport function getCornerPoint(\n  roi: Roi,\n  xAxisCorner: XCornerPosition,\n  yAxisCorner: YCornerPosition,\n): Point {\n  return {\n    x: getXCornerValue(roi, xAxisCorner),\n    y: getYCornerValue(roi, yAxisCorner),\n  };\n}\n\nfunction getXCornerValue(roi: Roi, xAxisCorner: XCornerPosition) {\n  switch (xAxisCorner) {\n    case 'left':\n      return roi.x;\n    case 'middle':\n      return roi.x + roi.width / 2;\n      break;\n    case 'right':\n      return roi.x + roi.width;\n    default:\n      assertUnreachable(xAxisCorner);\n  }\n}\n\nfunction getYCornerValue(roi: Roi, yAxisCorner: YCornerPosition) {\n  switch (yAxisCorner) {\n    case 'top':\n      return roi.y;\n    case 'middle':\n      return roi.y + roi.height / 2;\n    case 'bottom':\n      return roi.y + roi.height;\n    default:\n      assertUnreachable(yAxisCorner);\n  }\n}\n","import { CSSProperties, ReactNode } from 'react';\n\nimport { useRoiState } from '../hooks';\nimport { useRoiDispatch } from '../hooks/useRoiDispatch';\n\nexport interface BoxAnnotationProps {\n  id: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  style?: CSSProperties;\n  className?: string;\n  label?: ReactNode;\n}\n\nexport function Box({\n  id,\n  x,\n  y,\n  width,\n  height,\n  style,\n  label,\n  className,\n}: BoxAnnotationProps): JSX.Element {\n  const roiDispatch = useRoiDispatch();\n  const roiState = useRoiState();\n\n  return (\n    <div\n      id={id}\n      style={{\n        position: 'absolute',\n        left: x,\n        top: y,\n        width,\n        height,\n        cursor: roiState.mode === 'draw' ? 'crosshair' : 'grab',\n        ...style,\n      }}\n      className={className}\n      onMouseDown={(event) => {\n        if (event.altKey) {\n          return;\n        }\n        roiDispatch({\n          type: 'SELECT_BOX_AND_START_MOVE',\n          payload: {\n            id,\n          },\n        });\n        if (roiState.mode === 'select') {\n          // By preventing the event to fire on the container, we prevent\n          // the drawing of a new ROI to start.\n          event.stopPropagation();\n        }\n      }}\n    >\n      {label}\n    </div>\n  );\n}\n","import { useRoiDispatch } from '../hooks/useRoiDispatch';\nimport { CornerData } from '../utilities/corners';\n\nconst cursorSize = 4;\n\nexport function RoiBoxCorner({\n  corner,\n  roiId,\n}: {\n  corner: CornerData;\n  roiId: string;\n}) {\n  const roiDispatch = useRoiDispatch();\n\n  return (\n    <div\n      id={`corner-${corner.xPosition}-${corner.yPosition}`}\n      style={{\n        backgroundColor: '#44aaff',\n        opacity: 0.5,\n        stroke: 'black',\n        position: 'absolute',\n        top: corner.cy - cursorSize,\n        left: corner.cx - cursorSize,\n        width: cursorSize * 2,\n        height: cursorSize * 2,\n        cursor: corner.cursor,\n      }}\n      onMouseDown={(event) => {\n        if (event.altKey) {\n          return;\n        }\n        event.stopPropagation();\n        roiDispatch({\n          type: 'START_RESIZE',\n          payload: {\n            id: roiId,\n            xAxisCorner: corner.xPosition,\n            yAxisCorner: corner.yPosition,\n          },\n        });\n      }}\n    />\n  );\n}\n","import { memo } from 'react';\n\nimport { useRoiState } from '../../hooks';\nimport { Roi } from '../../types/Roi';\nimport { getAllCorners } from '../../utilities/corners';\nimport { Box } from '../Box';\nimport { RoiBoxCorner } from '../RoiBoxCorner';\nimport { RoiListProps } from './RoiList';\n\ninterface RoiBoxProps {\n  roi: Roi;\n  getStyle: RoiListProps['getStyle'];\n}\n\nfunction RoiBoxInternal(props: RoiBoxProps): JSX.Element {\n  const { roi, getStyle } = props;\n  const roiState = useRoiState();\n\n  const { x, y, width, height, id, label } = roi;\n  const isActive = id === roiState.selectedRoi;\n\n  return (\n    <>\n      <Box\n        id={id}\n        x={x}\n        y={y}\n        width={width}\n        height={height}\n        label={label}\n        {...getStyle(roi, isActive)}\n      />\n      {roiState.mode === 'select' &&\n        isActive &&\n        getAllCorners(roi).map((corner) => (\n          <RoiBoxCorner\n            corner={corner}\n            roiId={id}\n            key={`corner-${corner.xPosition}-${corner.yPosition}`}\n          />\n        ))}\n    </>\n  );\n}\n\nexport const RoiBox = memo(RoiBoxInternal);\n","import { useRois } from '../../hooks';\n\nimport { RoiBox } from './RoiBox';\nimport { Roi } from '../../types/Roi';\nimport { CSSProperties } from 'react';\n\ninterface StyleProperties {\n  /**\n   * Classname of the ROI box when not being selected or edited\n   */\n  className?: string;\n  /**\n   * Style of the ROI box when not being selected or edited.\n   */\n  style?: CSSProperties;\n}\n\nexport interface RoiListProps<TData = unknown> {\n  getStyle?: (roi: Roi<TData>, selected: boolean) => StyleProperties;\n}\n\nexport function RoiList<TData = unknown>(props: RoiListProps<TData>) {\n  const { getStyle = defaultGetStyle } = props;\n  const rois = useRois();\n\n  return (\n    <>\n      {rois.map((roi) => (\n        <RoiBox key={roi.id} roi={roi} getStyle={getStyle} />\n      ))}\n    </>\n  );\n}\n\nfunction defaultGetStyle<TData = unknown>(\n  _: Roi<TData>,\n  selected: boolean,\n): StyleProperties {\n  return {\n    style: {\n      backgroundColor: 'black',\n      opacity: selected ? 0.2 : 0.5,\n    },\n  };\n}\n","import { Box, Size } from '../types';\n\nexport type XCornerPosition = 'left' | 'right' | 'middle';\nexport type YCornerPosition = 'top' | 'bottom' | 'middle';\n\nexport function normalizeValue(value: number, max: number) {\n  return value / max;\n}\n\nexport function denormalizeValue(value: number, max: number) {\n  return value * max;\n}\n\nexport function normalizeBox<T extends Box>(position: T, size: Size) {\n  const { x, y, width, height } = position;\n  return {\n    x: normalizeValue(x, size.width),\n    y: normalizeValue(y, size.height),\n    width: normalizeValue(width, size.width),\n    height: normalizeValue(height, size.height),\n  };\n}\n\nexport function denormalizeBox<T extends Box>(position: T, size: Size) {\n  const { x, y, width, height } = position;\n  return {\n    x: denormalizeValue(x, size.width),\n    y: denormalizeValue(y, size.height),\n    width: denormalizeValue(width, size.width),\n    height: denormalizeValue(height, size.height),\n  };\n}\n","import { Box, Size } from '../types';\nimport { CommittedRoi, Roi } from '../types/Roi';\n\nimport { denormalizeBox, normalizeValue } from './coordinates';\n\nfunction createInitialBox(): Box {\n  return {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n  };\n}\n\nexport function createCommitedRoi<T>(\n  id: string,\n  options: Omit<Partial<CommittedRoi<T>>, 'id'> = {},\n): CommittedRoi<T> {\n  return {\n    id,\n    label: '',\n    ...createInitialBox(),\n    ...options,\n  };\n}\n\nexport function createRoi(\n  id: string,\n  size: Size,\n  options: Omit<Partial<Roi>, 'id'> = {},\n): Roi {\n  const committedRoi = createCommitedRoi(id, options);\n  return {\n    ...committedRoi,\n    action: {\n      type: 'idle',\n    },\n    ...options,\n    ...denormalizeBox(committedRoi, size),\n  };\n}\n\nexport function createCommitedRoiFromRoi<T>(\n  roi: Roi<T>,\n  size: Size,\n): CommittedRoi<T> {\n  const { action, ...obj } = roi;\n  return {\n    ...obj,\n    x: normalizeValue(roi.x, size.width),\n    y: normalizeValue(roi.y, size.height),\n    width: normalizeValue(roi.width, size.width),\n    height: normalizeValue(roi.height, size.height),\n  };\n}\n\nexport function createRoiFromCommittedRoi<T>(\n  roi: CommittedRoi<T>,\n  size: Size,\n): Roi<T> {\n  const { ...otherRoiProps } = roi;\n  return {\n    ...otherRoiProps,\n    action: {\n      type: 'idle',\n    },\n    ...denormalizeBox(roi, size),\n  };\n}\n\nexport function renormalizeRoiPosition(\n  position: Box,\n  oldSize: Size,\n  newSize: Size,\n): Box {\n  const wFactor = newSize.width / oldSize.width;\n  const hFactor = newSize.height / oldSize.height;\n  return {\n    x: position.x * wFactor,\n    y: position.y * hFactor,\n    width: position.width * wFactor,\n    height: position.height * hFactor,\n  };\n}\n","// src/utils/env.ts\nvar NOTHING = Symbol.for(\"immer-nothing\");\nvar DRAFTABLE = Symbol.for(\"immer-draftable\");\nvar DRAFT_STATE = Symbol.for(\"immer-state\");\n\n// src/utils/errors.ts\nvar errors = process.env.NODE_ENV !== \"production\" ? [\n  // All error codes, starting by 0:\n  function(plugin) {\n    return `The plugin for '${plugin}' has not been loaded into Immer. To enable the plugin, import and call \\`enable${plugin}()\\` when initializing your application.`;\n  },\n  function(thing) {\n    return `produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${thing}'`;\n  },\n  \"This object has been frozen and should not be mutated\",\n  function(data) {\n    return \"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \" + data;\n  },\n  \"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",\n  \"Immer forbids circular references\",\n  \"The first or second argument to `produce` must be a function\",\n  \"The third argument to `produce` must be a function or undefined\",\n  \"First argument to `createDraft` must be a plain object, an array, or an immerable object\",\n  \"First argument to `finishDraft` must be a draft returned by `createDraft`\",\n  function(thing) {\n    return `'current' expects a draft, got: ${thing}`;\n  },\n  \"Object.defineProperty() cannot be used on an Immer draft\",\n  \"Object.setPrototypeOf() cannot be used on an Immer draft\",\n  \"Immer only supports deleting array indices\",\n  \"Immer only supports setting array indices and the 'length' property\",\n  function(thing) {\n    return `'original' expects a draft, got: ${thing}`;\n  }\n  // Note: if more errors are added, the errorOffset in Patches.ts should be increased\n  // See Patches.ts for additional errors\n] : [];\nfunction die(error, ...args) {\n  if (process.env.NODE_ENV !== \"production\") {\n    const e = errors[error];\n    const msg = typeof e === \"function\" ? e.apply(null, args) : e;\n    throw new Error(`[Immer] ${msg}`);\n  }\n  throw new Error(\n    `[Immer] minified error nr: ${error}. Full error at: https://bit.ly/3cXEKWf`\n  );\n}\n\n// src/utils/common.ts\nvar getPrototypeOf = Object.getPrototypeOf;\nfunction isDraft(value) {\n  return !!value && !!value[DRAFT_STATE];\n}\nfunction isDraftable(value) {\n  if (!value)\n    return false;\n  return isPlainObject(value) || Array.isArray(value) || !!value[DRAFTABLE] || !!value.constructor?.[DRAFTABLE] || isMap(value) || isSet(value);\n}\nvar objectCtorString = Object.prototype.constructor.toString();\nfunction isPlainObject(value) {\n  if (!value || typeof value !== \"object\")\n    return false;\n  const proto = getPrototypeOf(value);\n  if (proto === null) {\n    return true;\n  }\n  const Ctor = Object.hasOwnProperty.call(proto, \"constructor\") && proto.constructor;\n  if (Ctor === Object)\n    return true;\n  return typeof Ctor == \"function\" && Function.toString.call(Ctor) === objectCtorString;\n}\nfunction original(value) {\n  if (!isDraft(value))\n    die(15, value);\n  return value[DRAFT_STATE].base_;\n}\nfunction each(obj, iter) {\n  if (getArchtype(obj) === 0 /* Object */) {\n    Object.entries(obj).forEach(([key, value]) => {\n      iter(key, value, obj);\n    });\n  } else {\n    obj.forEach((entry, index) => iter(index, entry, obj));\n  }\n}\nfunction getArchtype(thing) {\n  const state = thing[DRAFT_STATE];\n  return state ? state.type_ : Array.isArray(thing) ? 1 /* Array */ : isMap(thing) ? 2 /* Map */ : isSet(thing) ? 3 /* Set */ : 0 /* Object */;\n}\nfunction has(thing, prop) {\n  return getArchtype(thing) === 2 /* Map */ ? thing.has(prop) : Object.prototype.hasOwnProperty.call(thing, prop);\n}\nfunction get(thing, prop) {\n  return getArchtype(thing) === 2 /* Map */ ? thing.get(prop) : thing[prop];\n}\nfunction set(thing, propOrOldValue, value) {\n  const t = getArchtype(thing);\n  if (t === 2 /* Map */)\n    thing.set(propOrOldValue, value);\n  else if (t === 3 /* Set */) {\n    thing.add(value);\n  } else\n    thing[propOrOldValue] = value;\n}\nfunction is(x, y) {\n  if (x === y) {\n    return x !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\nfunction isMap(target) {\n  return target instanceof Map;\n}\nfunction isSet(target) {\n  return target instanceof Set;\n}\nfunction latest(state) {\n  return state.copy_ || state.base_;\n}\nfunction shallowCopy(base, strict) {\n  if (isMap(base)) {\n    return new Map(base);\n  }\n  if (isSet(base)) {\n    return new Set(base);\n  }\n  if (Array.isArray(base))\n    return Array.prototype.slice.call(base);\n  if (!strict && isPlainObject(base)) {\n    if (!getPrototypeOf(base)) {\n      const obj = /* @__PURE__ */ Object.create(null);\n      return Object.assign(obj, base);\n    }\n    return { ...base };\n  }\n  const descriptors = Object.getOwnPropertyDescriptors(base);\n  delete descriptors[DRAFT_STATE];\n  let keys = Reflect.ownKeys(descriptors);\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    const desc = descriptors[key];\n    if (desc.writable === false) {\n      desc.writable = true;\n      desc.configurable = true;\n    }\n    if (desc.get || desc.set)\n      descriptors[key] = {\n        configurable: true,\n        writable: true,\n        // could live with !!desc.set as well here...\n        enumerable: desc.enumerable,\n        value: base[key]\n      };\n  }\n  return Object.create(getPrototypeOf(base), descriptors);\n}\nfunction freeze(obj, deep = false) {\n  if (isFrozen(obj) || isDraft(obj) || !isDraftable(obj))\n    return obj;\n  if (getArchtype(obj) > 1) {\n    obj.set = obj.add = obj.clear = obj.delete = dontMutateFrozenCollections;\n  }\n  Object.freeze(obj);\n  if (deep)\n    each(obj, (_key, value) => freeze(value, true), true);\n  return obj;\n}\nfunction dontMutateFrozenCollections() {\n  die(2);\n}\nfunction isFrozen(obj) {\n  return Object.isFrozen(obj);\n}\n\n// src/utils/plugins.ts\nvar plugins = {};\nfunction getPlugin(pluginKey) {\n  const plugin = plugins[pluginKey];\n  if (!plugin) {\n    die(0, pluginKey);\n  }\n  return plugin;\n}\nfunction loadPlugin(pluginKey, implementation) {\n  if (!plugins[pluginKey])\n    plugins[pluginKey] = implementation;\n}\n\n// src/core/scope.ts\nvar currentScope;\nfunction getCurrentScope() {\n  return currentScope;\n}\nfunction createScope(parent_, immer_) {\n  return {\n    drafts_: [],\n    parent_,\n    immer_,\n    // Whenever the modified draft contains a draft from another scope, we\n    // need to prevent auto-freezing so the unowned draft can be finalized.\n    canAutoFreeze_: true,\n    unfinalizedDrafts_: 0\n  };\n}\nfunction usePatchesInScope(scope, patchListener) {\n  if (patchListener) {\n    getPlugin(\"Patches\");\n    scope.patches_ = [];\n    scope.inversePatches_ = [];\n    scope.patchListener_ = patchListener;\n  }\n}\nfunction revokeScope(scope) {\n  leaveScope(scope);\n  scope.drafts_.forEach(revokeDraft);\n  scope.drafts_ = null;\n}\nfunction leaveScope(scope) {\n  if (scope === currentScope) {\n    currentScope = scope.parent_;\n  }\n}\nfunction enterScope(immer2) {\n  return currentScope = createScope(currentScope, immer2);\n}\nfunction revokeDraft(draft) {\n  const state = draft[DRAFT_STATE];\n  if (state.type_ === 0 /* Object */ || state.type_ === 1 /* Array */)\n    state.revoke_();\n  else\n    state.revoked_ = true;\n}\n\n// src/core/finalize.ts\nfunction processResult(result, scope) {\n  scope.unfinalizedDrafts_ = scope.drafts_.length;\n  const baseDraft = scope.drafts_[0];\n  const isReplaced = result !== void 0 && result !== baseDraft;\n  if (isReplaced) {\n    if (baseDraft[DRAFT_STATE].modified_) {\n      revokeScope(scope);\n      die(4);\n    }\n    if (isDraftable(result)) {\n      result = finalize(scope, result);\n      if (!scope.parent_)\n        maybeFreeze(scope, result);\n    }\n    if (scope.patches_) {\n      getPlugin(\"Patches\").generateReplacementPatches_(\n        baseDraft[DRAFT_STATE].base_,\n        result,\n        scope.patches_,\n        scope.inversePatches_\n      );\n    }\n  } else {\n    result = finalize(scope, baseDraft, []);\n  }\n  revokeScope(scope);\n  if (scope.patches_) {\n    scope.patchListener_(scope.patches_, scope.inversePatches_);\n  }\n  return result !== NOTHING ? result : void 0;\n}\nfunction finalize(rootScope, value, path) {\n  if (isFrozen(value))\n    return value;\n  const state = value[DRAFT_STATE];\n  if (!state) {\n    each(\n      value,\n      (key, childValue) => finalizeProperty(rootScope, state, value, key, childValue, path),\n      true\n      // See #590, don't recurse into non-enumerable of non drafted objects\n    );\n    return value;\n  }\n  if (state.scope_ !== rootScope)\n    return value;\n  if (!state.modified_) {\n    maybeFreeze(rootScope, state.base_, true);\n    return state.base_;\n  }\n  if (!state.finalized_) {\n    state.finalized_ = true;\n    state.scope_.unfinalizedDrafts_--;\n    const result = state.copy_;\n    let resultEach = result;\n    let isSet2 = false;\n    if (state.type_ === 3 /* Set */) {\n      resultEach = new Set(result);\n      result.clear();\n      isSet2 = true;\n    }\n    each(\n      resultEach,\n      (key, childValue) => finalizeProperty(rootScope, state, result, key, childValue, path, isSet2)\n    );\n    maybeFreeze(rootScope, result, false);\n    if (path && rootScope.patches_) {\n      getPlugin(\"Patches\").generatePatches_(\n        state,\n        path,\n        rootScope.patches_,\n        rootScope.inversePatches_\n      );\n    }\n  }\n  return state.copy_;\n}\nfunction finalizeProperty(rootScope, parentState, targetObject, prop, childValue, rootPath, targetIsSet) {\n  if (process.env.NODE_ENV !== \"production\" && childValue === targetObject)\n    die(5);\n  if (isDraft(childValue)) {\n    const path = rootPath && parentState && parentState.type_ !== 3 /* Set */ && // Set objects are atomic since they have no keys.\n    !has(parentState.assigned_, prop) ? rootPath.concat(prop) : void 0;\n    const res = finalize(rootScope, childValue, path);\n    set(targetObject, prop, res);\n    if (isDraft(res)) {\n      rootScope.canAutoFreeze_ = false;\n    } else\n      return;\n  } else if (targetIsSet) {\n    targetObject.add(childValue);\n  }\n  if (isDraftable(childValue) && !isFrozen(childValue)) {\n    if (!rootScope.immer_.autoFreeze_ && rootScope.unfinalizedDrafts_ < 1) {\n      return;\n    }\n    finalize(rootScope, childValue);\n    if (!parentState || !parentState.scope_.parent_)\n      maybeFreeze(rootScope, childValue);\n  }\n}\nfunction maybeFreeze(scope, value, deep = false) {\n  if (!scope.parent_ && scope.immer_.autoFreeze_ && scope.canAutoFreeze_) {\n    freeze(value, deep);\n  }\n}\n\n// src/core/proxy.ts\nfunction createProxyProxy(base, parent) {\n  const isArray = Array.isArray(base);\n  const state = {\n    type_: isArray ? 1 /* Array */ : 0 /* Object */,\n    // Track which produce call this is associated with.\n    scope_: parent ? parent.scope_ : getCurrentScope(),\n    // True for both shallow and deep changes.\n    modified_: false,\n    // Used during finalization.\n    finalized_: false,\n    // Track which properties have been assigned (true) or deleted (false).\n    assigned_: {},\n    // The parent draft state.\n    parent_: parent,\n    // The base state.\n    base_: base,\n    // The base proxy.\n    draft_: null,\n    // set below\n    // The base copy with any updated values.\n    copy_: null,\n    // Called by the `produce` function.\n    revoke_: null,\n    isManual_: false\n  };\n  let target = state;\n  let traps = objectTraps;\n  if (isArray) {\n    target = [state];\n    traps = arrayTraps;\n  }\n  const { revoke, proxy } = Proxy.revocable(target, traps);\n  state.draft_ = proxy;\n  state.revoke_ = revoke;\n  return proxy;\n}\nvar objectTraps = {\n  get(state, prop) {\n    if (prop === DRAFT_STATE)\n      return state;\n    const source = latest(state);\n    if (!has(source, prop)) {\n      return readPropFromProto(state, source, prop);\n    }\n    const value = source[prop];\n    if (state.finalized_ || !isDraftable(value)) {\n      return value;\n    }\n    if (value === peek(state.base_, prop)) {\n      prepareCopy(state);\n      return state.copy_[prop] = createProxy(value, state);\n    }\n    return value;\n  },\n  has(state, prop) {\n    return prop in latest(state);\n  },\n  ownKeys(state) {\n    return Reflect.ownKeys(latest(state));\n  },\n  set(state, prop, value) {\n    const desc = getDescriptorFromProto(latest(state), prop);\n    if (desc?.set) {\n      desc.set.call(state.draft_, value);\n      return true;\n    }\n    if (!state.modified_) {\n      const current2 = peek(latest(state), prop);\n      const currentState = current2?.[DRAFT_STATE];\n      if (currentState && currentState.base_ === value) {\n        state.copy_[prop] = value;\n        state.assigned_[prop] = false;\n        return true;\n      }\n      if (is(value, current2) && (value !== void 0 || has(state.base_, prop)))\n        return true;\n      prepareCopy(state);\n      markChanged(state);\n    }\n    if (state.copy_[prop] === value && // special case: handle new props with value 'undefined'\n    (value !== void 0 || prop in state.copy_) || // special case: NaN\n    Number.isNaN(value) && Number.isNaN(state.copy_[prop]))\n      return true;\n    state.copy_[prop] = value;\n    state.assigned_[prop] = true;\n    return true;\n  },\n  deleteProperty(state, prop) {\n    if (peek(state.base_, prop) !== void 0 || prop in state.base_) {\n      state.assigned_[prop] = false;\n      prepareCopy(state);\n      markChanged(state);\n    } else {\n      delete state.assigned_[prop];\n    }\n    if (state.copy_) {\n      delete state.copy_[prop];\n    }\n    return true;\n  },\n  // Note: We never coerce `desc.value` into an Immer draft, because we can't make\n  // the same guarantee in ES5 mode.\n  getOwnPropertyDescriptor(state, prop) {\n    const owner = latest(state);\n    const desc = Reflect.getOwnPropertyDescriptor(owner, prop);\n    if (!desc)\n      return desc;\n    return {\n      writable: true,\n      configurable: state.type_ !== 1 /* Array */ || prop !== \"length\",\n      enumerable: desc.enumerable,\n      value: owner[prop]\n    };\n  },\n  defineProperty() {\n    die(11);\n  },\n  getPrototypeOf(state) {\n    return getPrototypeOf(state.base_);\n  },\n  setPrototypeOf() {\n    die(12);\n  }\n};\nvar arrayTraps = {};\neach(objectTraps, (key, fn) => {\n  arrayTraps[key] = function() {\n    arguments[0] = arguments[0][0];\n    return fn.apply(this, arguments);\n  };\n});\narrayTraps.deleteProperty = function(state, prop) {\n  if (process.env.NODE_ENV !== \"production\" && isNaN(parseInt(prop)))\n    die(13);\n  return arrayTraps.set.call(this, state, prop, void 0);\n};\narrayTraps.set = function(state, prop, value) {\n  if (process.env.NODE_ENV !== \"production\" && prop !== \"length\" && isNaN(parseInt(prop)))\n    die(14);\n  return objectTraps.set.call(this, state[0], prop, value, state[0]);\n};\nfunction peek(draft, prop) {\n  const state = draft[DRAFT_STATE];\n  const source = state ? latest(state) : draft;\n  return source[prop];\n}\nfunction readPropFromProto(state, source, prop) {\n  const desc = getDescriptorFromProto(source, prop);\n  return desc ? `value` in desc ? desc.value : (\n    // This is a very special case, if the prop is a getter defined by the\n    // prototype, we should invoke it with the draft as context!\n    desc.get?.call(state.draft_)\n  ) : void 0;\n}\nfunction getDescriptorFromProto(source, prop) {\n  if (!(prop in source))\n    return void 0;\n  let proto = getPrototypeOf(source);\n  while (proto) {\n    const desc = Object.getOwnPropertyDescriptor(proto, prop);\n    if (desc)\n      return desc;\n    proto = getPrototypeOf(proto);\n  }\n  return void 0;\n}\nfunction markChanged(state) {\n  if (!state.modified_) {\n    state.modified_ = true;\n    if (state.parent_) {\n      markChanged(state.parent_);\n    }\n  }\n}\nfunction prepareCopy(state) {\n  if (!state.copy_) {\n    state.copy_ = shallowCopy(\n      state.base_,\n      state.scope_.immer_.useStrictShallowCopy_\n    );\n  }\n}\n\n// src/core/immerClass.ts\nvar Immer2 = class {\n  constructor(config) {\n    this.autoFreeze_ = true;\n    this.useStrictShallowCopy_ = false;\n    /**\n     * The `produce` function takes a value and a \"recipe function\" (whose\n     * return value often depends on the base state). The recipe function is\n     * free to mutate its first argument however it wants. All mutations are\n     * only ever applied to a __copy__ of the base state.\n     *\n     * Pass only a function to create a \"curried producer\" which relieves you\n     * from passing the recipe function every time.\n     *\n     * Only plain objects and arrays are made mutable. All other objects are\n     * considered uncopyable.\n     *\n     * Note: This function is __bound__ to its `Immer` instance.\n     *\n     * @param {any} base - the initial state\n     * @param {Function} recipe - function that receives a proxy of the base state as first argument and which can be freely modified\n     * @param {Function} patchListener - optional function that will be called with all the patches produced here\n     * @returns {any} a new state, or the initial state if nothing was modified\n     */\n    this.produce = (base, recipe, patchListener) => {\n      if (typeof base === \"function\" && typeof recipe !== \"function\") {\n        const defaultBase = recipe;\n        recipe = base;\n        const self = this;\n        return function curriedProduce(base2 = defaultBase, ...args) {\n          return self.produce(base2, (draft) => recipe.call(this, draft, ...args));\n        };\n      }\n      if (typeof recipe !== \"function\")\n        die(6);\n      if (patchListener !== void 0 && typeof patchListener !== \"function\")\n        die(7);\n      let result;\n      if (isDraftable(base)) {\n        const scope = enterScope(this);\n        const proxy = createProxy(base, void 0);\n        let hasError = true;\n        try {\n          result = recipe(proxy);\n          hasError = false;\n        } finally {\n          if (hasError)\n            revokeScope(scope);\n          else\n            leaveScope(scope);\n        }\n        usePatchesInScope(scope, patchListener);\n        return processResult(result, scope);\n      } else if (!base || typeof base !== \"object\") {\n        result = recipe(base);\n        if (result === void 0)\n          result = base;\n        if (result === NOTHING)\n          result = void 0;\n        if (this.autoFreeze_)\n          freeze(result, true);\n        if (patchListener) {\n          const p = [];\n          const ip = [];\n          getPlugin(\"Patches\").generateReplacementPatches_(base, result, p, ip);\n          patchListener(p, ip);\n        }\n        return result;\n      } else\n        die(1, base);\n    };\n    this.produceWithPatches = (base, recipe) => {\n      if (typeof base === \"function\") {\n        return (state, ...args) => this.produceWithPatches(state, (draft) => base(draft, ...args));\n      }\n      let patches, inversePatches;\n      const result = this.produce(base, recipe, (p, ip) => {\n        patches = p;\n        inversePatches = ip;\n      });\n      return [result, patches, inversePatches];\n    };\n    if (typeof config?.autoFreeze === \"boolean\")\n      this.setAutoFreeze(config.autoFreeze);\n    if (typeof config?.useStrictShallowCopy === \"boolean\")\n      this.setUseStrictShallowCopy(config.useStrictShallowCopy);\n  }\n  createDraft(base) {\n    if (!isDraftable(base))\n      die(8);\n    if (isDraft(base))\n      base = current(base);\n    const scope = enterScope(this);\n    const proxy = createProxy(base, void 0);\n    proxy[DRAFT_STATE].isManual_ = true;\n    leaveScope(scope);\n    return proxy;\n  }\n  finishDraft(draft, patchListener) {\n    const state = draft && draft[DRAFT_STATE];\n    if (!state || !state.isManual_)\n      die(9);\n    const { scope_: scope } = state;\n    usePatchesInScope(scope, patchListener);\n    return processResult(void 0, scope);\n  }\n  /**\n   * Pass true to automatically freeze all copies created by Immer.\n   *\n   * By default, auto-freezing is enabled.\n   */\n  setAutoFreeze(value) {\n    this.autoFreeze_ = value;\n  }\n  /**\n   * Pass true to enable strict shallow copy.\n   *\n   * By default, immer does not copy the object descriptors such as getter, setter and non-enumrable properties.\n   */\n  setUseStrictShallowCopy(value) {\n    this.useStrictShallowCopy_ = value;\n  }\n  applyPatches(base, patches) {\n    let i;\n    for (i = patches.length - 1; i >= 0; i--) {\n      const patch = patches[i];\n      if (patch.path.length === 0 && patch.op === \"replace\") {\n        base = patch.value;\n        break;\n      }\n    }\n    if (i > -1) {\n      patches = patches.slice(i + 1);\n    }\n    const applyPatchesImpl = getPlugin(\"Patches\").applyPatches_;\n    if (isDraft(base)) {\n      return applyPatchesImpl(base, patches);\n    }\n    return this.produce(\n      base,\n      (draft) => applyPatchesImpl(draft, patches)\n    );\n  }\n};\nfunction createProxy(value, parent) {\n  const draft = isMap(value) ? getPlugin(\"MapSet\").proxyMap_(value, parent) : isSet(value) ? getPlugin(\"MapSet\").proxySet_(value, parent) : createProxyProxy(value, parent);\n  const scope = parent ? parent.scope_ : getCurrentScope();\n  scope.drafts_.push(draft);\n  return draft;\n}\n\n// src/core/current.ts\nfunction current(value) {\n  if (!isDraft(value))\n    die(10, value);\n  return currentImpl(value);\n}\nfunction currentImpl(value) {\n  if (!isDraftable(value) || isFrozen(value))\n    return value;\n  const state = value[DRAFT_STATE];\n  let copy;\n  if (state) {\n    if (!state.modified_)\n      return state.base_;\n    state.finalized_ = true;\n    copy = shallowCopy(value, state.scope_.immer_.useStrictShallowCopy_);\n  } else {\n    copy = shallowCopy(value, true);\n  }\n  each(copy, (key, childValue) => {\n    set(copy, key, currentImpl(childValue));\n  });\n  if (state) {\n    state.finalized_ = false;\n  }\n  return copy;\n}\n\n// src/plugins/patches.ts\nfunction enablePatches() {\n  const errorOffset = 16;\n  if (process.env.NODE_ENV !== \"production\") {\n    errors.push(\n      'Sets cannot have \"replace\" patches.',\n      function(op) {\n        return \"Unsupported patch operation: \" + op;\n      },\n      function(path) {\n        return \"Cannot apply patch, path doesn't resolve: \" + path;\n      },\n      \"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"\n    );\n  }\n  const REPLACE = \"replace\";\n  const ADD = \"add\";\n  const REMOVE = \"remove\";\n  function generatePatches_(state, basePath, patches, inversePatches) {\n    switch (state.type_) {\n      case 0 /* Object */:\n      case 2 /* Map */:\n        return generatePatchesFromAssigned(\n          state,\n          basePath,\n          patches,\n          inversePatches\n        );\n      case 1 /* Array */:\n        return generateArrayPatches(state, basePath, patches, inversePatches);\n      case 3 /* Set */:\n        return generateSetPatches(\n          state,\n          basePath,\n          patches,\n          inversePatches\n        );\n    }\n  }\n  function generateArrayPatches(state, basePath, patches, inversePatches) {\n    let { base_, assigned_ } = state;\n    let copy_ = state.copy_;\n    if (copy_.length < base_.length) {\n      ;\n      [base_, copy_] = [copy_, base_];\n      [patches, inversePatches] = [inversePatches, patches];\n    }\n    for (let i = 0; i < base_.length; i++) {\n      if (assigned_[i] && copy_[i] !== base_[i]) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: REPLACE,\n          path,\n          // Need to maybe clone it, as it can in fact be the original value\n          // due to the base/copy inversion at the start of this function\n          value: clonePatchValueIfNeeded(copy_[i])\n        });\n        inversePatches.push({\n          op: REPLACE,\n          path,\n          value: clonePatchValueIfNeeded(base_[i])\n        });\n      }\n    }\n    for (let i = base_.length; i < copy_.length; i++) {\n      const path = basePath.concat([i]);\n      patches.push({\n        op: ADD,\n        path,\n        // Need to maybe clone it, as it can in fact be the original value\n        // due to the base/copy inversion at the start of this function\n        value: clonePatchValueIfNeeded(copy_[i])\n      });\n    }\n    for (let i = copy_.length - 1; base_.length <= i; --i) {\n      const path = basePath.concat([i]);\n      inversePatches.push({\n        op: REMOVE,\n        path\n      });\n    }\n  }\n  function generatePatchesFromAssigned(state, basePath, patches, inversePatches) {\n    const { base_, copy_ } = state;\n    each(state.assigned_, (key, assignedValue) => {\n      const origValue = get(base_, key);\n      const value = get(copy_, key);\n      const op = !assignedValue ? REMOVE : has(base_, key) ? REPLACE : ADD;\n      if (origValue === value && op === REPLACE)\n        return;\n      const path = basePath.concat(key);\n      patches.push(op === REMOVE ? { op, path } : { op, path, value });\n      inversePatches.push(\n        op === ADD ? { op: REMOVE, path } : op === REMOVE ? { op: ADD, path, value: clonePatchValueIfNeeded(origValue) } : { op: REPLACE, path, value: clonePatchValueIfNeeded(origValue) }\n      );\n    });\n  }\n  function generateSetPatches(state, basePath, patches, inversePatches) {\n    let { base_, copy_ } = state;\n    let i = 0;\n    base_.forEach((value) => {\n      if (!copy_.has(value)) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: REMOVE,\n          path,\n          value\n        });\n        inversePatches.unshift({\n          op: ADD,\n          path,\n          value\n        });\n      }\n      i++;\n    });\n    i = 0;\n    copy_.forEach((value) => {\n      if (!base_.has(value)) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: ADD,\n          path,\n          value\n        });\n        inversePatches.unshift({\n          op: REMOVE,\n          path,\n          value\n        });\n      }\n      i++;\n    });\n  }\n  function generateReplacementPatches_(baseValue, replacement, patches, inversePatches) {\n    patches.push({\n      op: REPLACE,\n      path: [],\n      value: replacement === NOTHING ? void 0 : replacement\n    });\n    inversePatches.push({\n      op: REPLACE,\n      path: [],\n      value: baseValue\n    });\n  }\n  function applyPatches_(draft, patches) {\n    patches.forEach((patch) => {\n      const { path, op } = patch;\n      let base = draft;\n      for (let i = 0; i < path.length - 1; i++) {\n        const parentType = getArchtype(base);\n        let p = path[i];\n        if (typeof p !== \"string\" && typeof p !== \"number\") {\n          p = \"\" + p;\n        }\n        if ((parentType === 0 /* Object */ || parentType === 1 /* Array */) && (p === \"__proto__\" || p === \"constructor\"))\n          die(errorOffset + 3);\n        if (typeof base === \"function\" && p === \"prototype\")\n          die(errorOffset + 3);\n        base = get(base, p);\n        if (typeof base !== \"object\")\n          die(errorOffset + 2, path.join(\"/\"));\n      }\n      const type = getArchtype(base);\n      const value = deepClonePatchValue(patch.value);\n      const key = path[path.length - 1];\n      switch (op) {\n        case REPLACE:\n          switch (type) {\n            case 2 /* Map */:\n              return base.set(key, value);\n            case 3 /* Set */:\n              die(errorOffset);\n            default:\n              return base[key] = value;\n          }\n        case ADD:\n          switch (type) {\n            case 1 /* Array */:\n              return key === \"-\" ? base.push(value) : base.splice(key, 0, value);\n            case 2 /* Map */:\n              return base.set(key, value);\n            case 3 /* Set */:\n              return base.add(value);\n            default:\n              return base[key] = value;\n          }\n        case REMOVE:\n          switch (type) {\n            case 1 /* Array */:\n              return base.splice(key, 1);\n            case 2 /* Map */:\n              return base.delete(key);\n            case 3 /* Set */:\n              return base.delete(patch.value);\n            default:\n              return delete base[key];\n          }\n        default:\n          die(errorOffset + 1, op);\n      }\n    });\n    return draft;\n  }\n  function deepClonePatchValue(obj) {\n    if (!isDraftable(obj))\n      return obj;\n    if (Array.isArray(obj))\n      return obj.map(deepClonePatchValue);\n    if (isMap(obj))\n      return new Map(\n        Array.from(obj.entries()).map(([k, v]) => [k, deepClonePatchValue(v)])\n      );\n    if (isSet(obj))\n      return new Set(Array.from(obj).map(deepClonePatchValue));\n    const cloned = Object.create(getPrototypeOf(obj));\n    for (const key in obj)\n      cloned[key] = deepClonePatchValue(obj[key]);\n    if (has(obj, DRAFTABLE))\n      cloned[DRAFTABLE] = obj[DRAFTABLE];\n    return cloned;\n  }\n  function clonePatchValueIfNeeded(obj) {\n    if (isDraft(obj)) {\n      return deepClonePatchValue(obj);\n    } else\n      return obj;\n  }\n  loadPlugin(\"Patches\", {\n    applyPatches_,\n    generatePatches_,\n    generateReplacementPatches_\n  });\n}\n\n// src/plugins/mapset.ts\nfunction enableMapSet() {\n  class DraftMap extends Map {\n    constructor(target, parent) {\n      super();\n      this[DRAFT_STATE] = {\n        type_: 2 /* Map */,\n        parent_: parent,\n        scope_: parent ? parent.scope_ : getCurrentScope(),\n        modified_: false,\n        finalized_: false,\n        copy_: void 0,\n        assigned_: void 0,\n        base_: target,\n        draft_: this,\n        isManual_: false,\n        revoked_: false\n      };\n    }\n    get size() {\n      return latest(this[DRAFT_STATE]).size;\n    }\n    has(key) {\n      return latest(this[DRAFT_STATE]).has(key);\n    }\n    set(key, value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!latest(state).has(key) || latest(state).get(key) !== value) {\n        prepareMapCopy(state);\n        markChanged(state);\n        state.assigned_.set(key, true);\n        state.copy_.set(key, value);\n        state.assigned_.set(key, true);\n      }\n      return this;\n    }\n    delete(key) {\n      if (!this.has(key)) {\n        return false;\n      }\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareMapCopy(state);\n      markChanged(state);\n      if (state.base_.has(key)) {\n        state.assigned_.set(key, false);\n      } else {\n        state.assigned_.delete(key);\n      }\n      state.copy_.delete(key);\n      return true;\n    }\n    clear() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (latest(state).size) {\n        prepareMapCopy(state);\n        markChanged(state);\n        state.assigned_ = /* @__PURE__ */ new Map();\n        each(state.base_, (key) => {\n          state.assigned_.set(key, false);\n        });\n        state.copy_.clear();\n      }\n    }\n    forEach(cb, thisArg) {\n      const state = this[DRAFT_STATE];\n      latest(state).forEach((_value, key, _map) => {\n        cb.call(thisArg, this.get(key), key, this);\n      });\n    }\n    get(key) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      const value = latest(state).get(key);\n      if (state.finalized_ || !isDraftable(value)) {\n        return value;\n      }\n      if (value !== state.base_.get(key)) {\n        return value;\n      }\n      const draft = createProxy(value, state);\n      prepareMapCopy(state);\n      state.copy_.set(key, draft);\n      return draft;\n    }\n    keys() {\n      return latest(this[DRAFT_STATE]).keys();\n    }\n    values() {\n      const iterator = this.keys();\n      return {\n        [Symbol.iterator]: () => this.values(),\n        next: () => {\n          const r = iterator.next();\n          if (r.done)\n            return r;\n          const value = this.get(r.value);\n          return {\n            done: false,\n            value\n          };\n        }\n      };\n    }\n    entries() {\n      const iterator = this.keys();\n      return {\n        [Symbol.iterator]: () => this.entries(),\n        next: () => {\n          const r = iterator.next();\n          if (r.done)\n            return r;\n          const value = this.get(r.value);\n          return {\n            done: false,\n            value: [r.value, value]\n          };\n        }\n      };\n    }\n    [(DRAFT_STATE, Symbol.iterator)]() {\n      return this.entries();\n    }\n  }\n  function proxyMap_(target, parent) {\n    return new DraftMap(target, parent);\n  }\n  function prepareMapCopy(state) {\n    if (!state.copy_) {\n      state.assigned_ = /* @__PURE__ */ new Map();\n      state.copy_ = new Map(state.base_);\n    }\n  }\n  class DraftSet extends Set {\n    constructor(target, parent) {\n      super();\n      this[DRAFT_STATE] = {\n        type_: 3 /* Set */,\n        parent_: parent,\n        scope_: parent ? parent.scope_ : getCurrentScope(),\n        modified_: false,\n        finalized_: false,\n        copy_: void 0,\n        base_: target,\n        draft_: this,\n        drafts_: /* @__PURE__ */ new Map(),\n        revoked_: false,\n        isManual_: false\n      };\n    }\n    get size() {\n      return latest(this[DRAFT_STATE]).size;\n    }\n    has(value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!state.copy_) {\n        return state.base_.has(value);\n      }\n      if (state.copy_.has(value))\n        return true;\n      if (state.drafts_.has(value) && state.copy_.has(state.drafts_.get(value)))\n        return true;\n      return false;\n    }\n    add(value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!this.has(value)) {\n        prepareSetCopy(state);\n        markChanged(state);\n        state.copy_.add(value);\n      }\n      return this;\n    }\n    delete(value) {\n      if (!this.has(value)) {\n        return false;\n      }\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      markChanged(state);\n      return state.copy_.delete(value) || (state.drafts_.has(value) ? state.copy_.delete(state.drafts_.get(value)) : (\n        /* istanbul ignore next */\n        false\n      ));\n    }\n    clear() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (latest(state).size) {\n        prepareSetCopy(state);\n        markChanged(state);\n        state.copy_.clear();\n      }\n    }\n    values() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      return state.copy_.values();\n    }\n    entries() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      return state.copy_.entries();\n    }\n    keys() {\n      return this.values();\n    }\n    [(DRAFT_STATE, Symbol.iterator)]() {\n      return this.values();\n    }\n    forEach(cb, thisArg) {\n      const iterator = this.values();\n      let result = iterator.next();\n      while (!result.done) {\n        cb.call(thisArg, result.value, result.value, this);\n        result = iterator.next();\n      }\n    }\n  }\n  function proxySet_(target, parent) {\n    return new DraftSet(target, parent);\n  }\n  function prepareSetCopy(state) {\n    if (!state.copy_) {\n      state.copy_ = /* @__PURE__ */ new Set();\n      state.base_.forEach((value) => {\n        if (isDraftable(value)) {\n          const draft = createProxy(value, state);\n          state.drafts_.set(value, draft);\n          state.copy_.add(draft);\n        } else {\n          state.copy_.add(value);\n        }\n      });\n    }\n  }\n  function assertUnrevoked(state) {\n    if (state.revoked_)\n      die(3, JSON.stringify(latest(state)));\n  }\n  loadPlugin(\"MapSet\", { proxyMap_, proxySet_ });\n}\n\n// src/immer.ts\nvar immer = new Immer2();\nvar produce = immer.produce;\nvar produceWithPatches = immer.produceWithPatches.bind(\n  immer\n);\nvar setAutoFreeze = immer.setAutoFreeze.bind(immer);\nvar setUseStrictShallowCopy = immer.setUseStrictShallowCopy.bind(immer);\nvar applyPatches = immer.applyPatches.bind(immer);\nvar createDraft = immer.createDraft.bind(immer);\nvar finishDraft = immer.finishDraft.bind(immer);\nfunction castDraft(value) {\n  return value;\n}\nfunction castImmutable(value) {\n  return value;\n}\nexport {\n  Immer2 as Immer,\n  applyPatches,\n  castDraft,\n  castImmutable,\n  createDraft,\n  current,\n  enableMapSet,\n  enablePatches,\n  finishDraft,\n  freeze,\n  DRAFTABLE as immerable,\n  isDraft,\n  isDraftable,\n  NOTHING as nothing,\n  original,\n  produce,\n  produceWithPatches,\n  setAutoFreeze,\n  setUseStrictShallowCopy\n};\n//# sourceMappingURL=immer.mjs.map","import { Draft } from 'immer';\n\nimport { Box } from '../../types';\nimport { Roi } from '../../types/Roi';\nimport { assert } from '../../utilities/assert';\nimport { denormalizeBox } from '../../utilities/coordinates';\nimport { ReactRoiState } from '../roiReducer';\n\nexport function cancelAction(draft: Draft<ReactRoiState>) {\n  const rois = draft.rois.filter((roi) => roi.action.type !== 'idle');\n\n  if (rois.length === 0) {\n    return;\n  }\n  assert(rois.length === 1, 'Multiple rois are being edited at the same time');\n\n  const roi = rois[0];\n  if (roi.action.type === 'drawing') {\n    const roiIndex = draft.rois.findIndex((r) => r.id === roi.id);\n    draft.rois.splice(roiIndex, 1);\n  } else {\n    // Revert to the previous state\n    const committedRoi = draft.committedRois.find((r) => r.id === roi.id);\n    assert(committedRoi);\n    Object.assign<Roi, Box>(roi, denormalizeBox(committedRoi, draft.size));\n  }\n  draft.action = 'idle';\n  roi.action = {\n    type: 'idle',\n  };\n}\n","import { Draft } from 'immer';\n\nimport { Box } from '../../types';\nimport { CommittedRoi, Roi } from '../../types/Roi';\nimport { denormalizeBox, normalizeBox } from '../../utilities/coordinates';\nimport { ReactRoiState } from '../roiReducer';\n\nfunction boundRoi<T extends Box>(\n  roi: T,\n  actionType: Roi['action']['type'],\n): Box {\n  // Bound points and recalculate width and height\n  const result: Box = {\n    x: roi.x,\n    y: roi.y,\n    width: roi.width,\n    height: roi.height,\n  };\n\n  if (actionType === 'drawing' || actionType === 'resizing') {\n    if (result.x < 0) {\n      result.width += result.x;\n      result.x = 0;\n    }\n    if (result.y < 0) {\n      result.height += result.y;\n      result.y = 0;\n    }\n\n    // Cut if the ROI is outside the boundaries\n    if (result.height + result.y > 1) {\n      result.height = 1 - result.y;\n    }\n    if (result.width + result.x > 1) {\n      result.width = 1 - result.x;\n    }\n  } else {\n    // Move back inside the viewport if outside the boundaries\n    if (result.x < 0) {\n      result.x = 0;\n    }\n    if (result.y < 0) {\n      result.y = 0;\n    }\n    if (result.x + result.width > 1) {\n      result.x = 1 - result.width;\n    }\n    if (result.y + result.height > 1) {\n      result.y = 1 - result.height;\n    }\n  }\n  return result;\n}\n\nexport function updateCommitedRoiPosition(\n  draft: ReactRoiState,\n  committedRoi: Draft<CommittedRoi>,\n  roi: Draft<Roi>,\n) {\n  const normalizedBox = boundRoi(\n    normalizeBox(roi, draft.size),\n    roi.action.type,\n  );\n  if (normalizedBox.height === 0 || normalizedBox.width === 0) {\n    // Revert changes since the ROI is no longer visible\n    Object.assign<Roi, Box>(roi, denormalizeBox(committedRoi, draft.size));\n  } else {\n    Object.assign<CommittedRoi, Box>(committedRoi, normalizedBox);\n    Object.assign<Roi, Box>(roi, denormalizeBox(committedRoi, draft.size));\n  }\n}\n","import { assert } from '../../utilities/assert';\nimport { createCommitedRoiFromRoi } from '../../utilities/rois';\nimport { ReactRoiState } from '../roiReducer';\n\nimport { updateCommitedRoiPosition } from './roi';\n\nexport function endAction(draft: ReactRoiState) {\n  draft.action = 'idle';\n  const { selectedRoi, rois, committedRois } = draft;\n  if (!selectedRoi) return;\n  const roi = rois.find((roi) => roi.id === selectedRoi);\n  const commitedRoi = committedRois.find((roi) => roi.id === selectedRoi);\n  assert(roi, 'Selected ROI not found');\n\n  if (!roi) return;\n\n  if (commitedRoi) {\n    assert(roi.action.type !== 'drawing', 'Drawing ROI should not be commited');\n    updateCommitedRoiPosition(draft, commitedRoi, roi);\n  } else {\n    assert(roi.action.type === 'drawing');\n    const newCommitedRoi = createCommitedRoiFromRoi(roi, draft.size);\n    updateCommitedRoiPosition(draft, newCommitedRoi, roi);\n    draft.committedRois.push(newCommitedRoi);\n  }\n  roi.action = {\n    type: 'idle',\n  };\n}\n","import { Draft } from 'immer';\n\nimport { Point } from '../../types';\nimport { Roi } from '../../types/Roi';\nimport { assert, assertUnreachable } from '../../utilities/assert';\nimport { ReactRoiState } from '../roiReducer';\n\nexport function mouseMove(draft: ReactRoiState, event: MouseEvent) {\n  switch (draft.action) {\n    case 'idle':\n      return;\n    case 'panning':\n      draft.panZoom.translation[0] += event.movementX;\n      draft.panZoom.translation[1] += event.movementY;\n      return;\n    case 'moving':\n    case 'drawing':\n    case 'resizing': {\n      const { selectedRoi, rois } = draft;\n      const roi = rois.find((roi) => roi.id === selectedRoi);\n      assert(roi);\n      updateRoiBox(draft, roi, { x: event.movementX, y: event.movementY });\n      return;\n    }\n    default:\n      assertUnreachable(draft.action, 'Invalid action type');\n  }\n}\n\nexport function updateRoiBox(\n  draft: Draft<ReactRoiState>,\n  roi: Draft<Roi>,\n  movement: Point,\n) {\n  const movementX = movement.x / draft.panZoom.scale;\n  const movementY = movement.y / draft.panZoom.scale;\n  switch (roi.action.type) {\n    case 'idle':\n      return;\n    case 'moving':\n      roi.x += movementX;\n      roi.y += movementY;\n      break;\n    case 'resizing': {\n      resize(draft, roi, movement);\n      break;\n    }\n    case 'drawing':\n      resize(draft, roi, movement);\n      break;\n    default:\n      assertUnreachable(roi.action, 'Invalid action type');\n  }\n}\n\nfunction resize(draft: Draft<ReactRoiState>, roi: Draft<Roi>, movement: Point) {\n  assert(roi.action.type === 'resizing' || roi.action.type === 'drawing');\n  const movementX = movement.x / draft.panZoom.scale;\n  const movementY = movement.y / draft.panZoom.scale;\n  const xAxisCorner = roi.action.xAxisCorner;\n  // Handle X axis\n  switch (xAxisCorner) {\n    case 'left': {\n      const newX = roi.x + movementX;\n      if (newX <= roi.x + roi.width) {\n        roi.x = newX;\n        roi.width -= movementX;\n      } else {\n        roi.x = roi.x + roi.width;\n        roi.width = newX - roi.x;\n        roi.action.xAxisCorner = 'right';\n      }\n      break;\n    }\n    case 'right': {\n      const newWidth = roi.width + movementX;\n      if (newWidth >= 0) {\n        roi.width = newWidth;\n      } else {\n        roi.x = roi.x + newWidth;\n        roi.width = -newWidth;\n        roi.action.xAxisCorner = 'left';\n      }\n      break;\n    }\n    case 'middle':\n      // Don't touch x\n      break;\n    default:\n      assertUnreachable(xAxisCorner);\n  }\n\n  // Handle Y axis\n  const yAxisCorner = roi.action.yAxisCorner;\n  switch (yAxisCorner) {\n    case 'top': {\n      const newX = roi.y + movementY;\n      if (newX <= roi.y + roi.height) {\n        roi.y = newX;\n        roi.height -= movementY;\n      } else {\n        roi.y = roi.y + roi.height;\n        roi.height = newX - roi.y;\n        roi.action.yAxisCorner = 'bottom';\n      }\n      break;\n    }\n    case 'bottom': {\n      const newWidth = roi.height + movementY;\n      if (newWidth >= 0) {\n        roi.height = newWidth;\n      } else {\n        roi.y = roi.y + newWidth;\n        roi.height = -newWidth;\n        roi.action.yAxisCorner = 'top';\n      }\n      break;\n    }\n    case 'middle':\n      // Don't touch y\n      break;\n    default:\n      assertUnreachable(yAxisCorner);\n  }\n}\n","import { PanZoomContext } from '../context/contexts';\n\nexport function applyTransformX(panZoom: PanZoomContext, x: number) {\n  return panZoom.scale * x + panZoom.translation[0];\n}\n\nexport function applyTransformY(panZoom: PanZoomContext, y: number) {\n  return panZoom.scale * y + panZoom.translation[1];\n}\n\nexport function applyInverseX(panzoom: PanZoomContext, x: number) {\n  return (x - panzoom.translation[0]) / panzoom.scale;\n}\n\nexport function applyInverseY(panzoom: PanZoomContext, y: number) {\n  return (y - panzoom.translation[1]) / panzoom.scale;\n}\n","import { Roi } from '../../types/Roi';\nimport { applyInverseX, applyInverseY } from '../../utilities/panZoom';\nimport { createRoi } from '../../utilities/rois';\nimport { StartDrawPayload, ReactRoiState } from '../roiReducer';\n\nexport function startDraw(draft: ReactRoiState, payload: StartDrawPayload) {\n  const { event, containerBoundingRect } = payload;\n  const emptyRoi = createRoi(crypto.randomUUID(), draft.size);\n\n  if (payload.isPanZooming) {\n    draft.action = 'panning';\n    return;\n  }\n  switch (draft.mode) {\n    case 'draw': {\n      const x = applyInverseX(\n        draft.panZoom,\n        event.clientX - containerBoundingRect.x,\n      );\n      const y = applyInverseY(\n        draft.panZoom,\n        event.clientY - containerBoundingRect.y,\n      );\n\n      const roi: Roi = {\n        ...emptyRoi,\n        action: {\n          type: 'drawing',\n          xAxisCorner: 'left',\n          yAxisCorner: 'top',\n        },\n\n        x,\n        y,\n        width: 0,\n        height: 0,\n\n        data: undefined,\n      };\n      draft.selectedRoi = roi.id;\n      draft.rois.push(roi);\n      draft.action = 'drawing';\n      break;\n    }\n    case 'select': {\n      draft.selectedRoi = undefined;\n      break;\n    }\n    default:\n      break;\n  }\n}\n","import { applyInverseX, applyInverseY } from '../../utilities/panZoom';\nimport { ReactRoiState, ZoomPayload } from '../roiReducer';\n\nconst MAX_ZOOM = 10;\nconst MIN_ZOOM = 0.5;\n\nexport function zoomAction(draft: ReactRoiState, zoom: ZoomPayload) {\n  const { scale: zoomScale, refBoundingClientRect, clientX, clientY } = zoom;\n  const { scale, translation } = draft.panZoom;\n  const scaleNew = Math.max(MIN_ZOOM, Math.min(scale * zoomScale, MAX_ZOOM));\n\n  const x = clientX - refBoundingClientRect.left;\n  const y = clientY - refBoundingClientRect.top;\n\n  // We apply the inverse transformation to the mouse position\n  // To obtain the coordinates in the original coordinate system\n  const originalX = applyInverseX(draft.panZoom, x);\n  const originalY = applyInverseY(draft.panZoom, y);\n\n  // The new scale is already known.\n  draft.panZoom.scale = scaleNew;\n\n  // Compute the new translation so that transforming the point under the mouse\n  // remains at the same position before and after the zoom.\n  //     affine(originalX) = affine_new(originalX)\n  //     translation_new = (scale - scale_new) * originalX + translation\n  translation[0] = (scale - scaleNew) * originalX + translation[0];\n  translation[1] = (scale - scaleNew) * originalY + translation[1];\n}\n\nexport function resetZoomAction(draft: ReactRoiState) {\n  draft.panZoom.scale = 1;\n  draft.panZoom.translation = [0, 0];\n}\n","import { produce } from 'immer';\n\nimport { Box } from '../types';\nimport { CommittedRoi, Roi } from '../types/Roi';\nimport { assert, assertUnreachable } from '../utilities/assert';\nimport { XCornerPosition, YCornerPosition } from '../utilities/coordinates';\nimport {\n  createCommitedRoi,\n  createRoi,\n  renormalizeRoiPosition,\n} from '../utilities/rois';\n\nimport { PanZoomContext } from './contexts';\nimport { cancelAction } from './updaters/cancelAction';\nimport { endAction } from './updaters/endAction';\nimport { mouseMove } from './updaters/mouseMove';\nimport { startDraw } from './updaters/startDraw';\nimport { resetZoomAction, zoomAction } from './updaters/zoom';\n\ninterface Size {\n  width: number;\n  height: number;\n}\nexport interface ReactRoiState<T = unknown> {\n  /**\n   * Current mode\n   */\n  mode: RoiMode;\n\n  /**\n   * Identification of the selected object\n   */\n  selectedRoi?: string;\n\n  /**\n   * Current action being performed\n   */\n  action: 'idle' | 'moving' | 'drawing' | 'panning' | 'resizing';\n\n  /**\n   * rois\n   */\n  rois: Array<Roi<T>>;\n\n  /**\n   * commited rois\n   */\n  committedRois: Array<CommittedRoi<T>>;\n\n  /**\n   * Size of the container used to normalize coordinates\n   */\n  size: Size;\n\n  /**\n   * Defines the current affine transformation being applied to the container\n   */\n  panZoom: PanZoomContext;\n}\n\nexport type RoiMode = 'select' | 'draw';\n\nexport type CreateUpdateRoiPayload = Partial<CommittedRoi> & { id: string };\n\nexport interface ZoomPayload {\n  scale: number;\n  refBoundingClientRect: DOMRect;\n  clientX: number;\n  clientY: number;\n}\n\nexport interface StartDrawPayload {\n  event: MouseEvent | React.MouseEvent;\n  containerBoundingRect: DOMRect;\n  isPanZooming: boolean;\n}\n\nexport type RoiReducerAction =\n  | { type: 'SET_MODE'; payload: RoiMode }\n  | {\n      type: 'CREATE_ROI';\n      payload: CreateUpdateRoiPayload;\n    }\n  | {\n      type: 'SET_SIZE';\n      payload: {\n        width: number;\n        height: number;\n      };\n    }\n  | {\n      type: 'UPDATE_ROI';\n      payload: CreateUpdateRoiPayload;\n    }\n  | { type: 'REMOVE_ROI'; payload?: string }\n  | {\n      type: 'START_RESIZE';\n      payload: {\n        id: string;\n        xAxisCorner: XCornerPosition;\n        yAxisCorner: YCornerPosition;\n      };\n    }\n  | {\n      type: 'START_DRAW';\n      payload: StartDrawPayload;\n    }\n  | {\n      type: 'MOUSE_MOVE';\n      payload: MouseEvent;\n    }\n  | {\n      type: 'END_ACTION';\n    }\n  | { type: 'CANCEL_ACTION'; payload: React.KeyboardEvent }\n  | {\n      type: 'SELECT_BOX_AND_START_MOVE';\n      payload: { id: string };\n    }\n  | {\n      type: 'ZOOM';\n      payload: ZoomPayload;\n    }\n  | {\n      type: 'RESET_ZOOM';\n    };\n\nexport function roiReducer(\n  state: ReactRoiState,\n  action: RoiReducerAction,\n): ReactRoiState {\n  return produce(state, (draft) => {\n    const type = action.type;\n    switch (type) {\n      case 'SET_MODE':\n        draft.mode = action.payload;\n        break;\n      case 'SET_SIZE': {\n        // Ignore if size is 0\n        if (action.payload.width === 0 || action.payload.height === 0) return;\n\n        // Update absolute positions\n        draft.rois.forEach((roi) => {\n          Object.assign<Roi, Box>(\n            roi,\n            renormalizeRoiPosition(roi, draft.size, action.payload),\n          );\n        });\n        draft.size = action.payload;\n        break;\n      }\n      case 'REMOVE_ROI': {\n        const id = action.payload ?? draft.selectedRoi;\n        const index = draft.rois.findIndex((roi) => roi.id === id);\n        if (index === -1) return;\n        draft.rois.splice(index, 1);\n        draft.committedRois.splice(index, 1);\n        draft.selectedRoi = undefined;\n        return;\n      }\n\n      case 'CREATE_ROI': {\n        const { id, ...otherRoiProps } = action.payload;\n        const commitedRoi = createCommitedRoi(id, otherRoiProps);\n        draft.committedRois.push(commitedRoi);\n        draft.rois.push(createRoi(id, draft.size, otherRoiProps));\n        draft.selectedRoi = commitedRoi.id;\n        break;\n      }\n\n      case 'UPDATE_ROI': {\n        const { id, ...updatedData } = action.payload;\n        if (!id) return;\n        const commitedRoi = draft.committedRois.find((roi) => roi.id === id);\n        const roi = draft.rois.find((roi) => roi.id === id);\n\n        assert(roi, 'ROI not found');\n        assert(commitedRoi, 'Commited ROI not found');\n\n        Object.assign<CommittedRoi, Partial<CommittedRoi>>(\n          commitedRoi,\n          updatedData,\n        );\n        Object.assign<Roi, Partial<Roi>>(roi, updatedData);\n        break;\n      }\n\n      case 'START_RESIZE': {\n        const { id, xAxisCorner, yAxisCorner } = action.payload;\n        const { rois } = draft;\n        const roi = rois.find((roi) => roi.id === id);\n        assert(roi, 'ROI not found');\n        draft.action = 'resizing';\n        roi.action = {\n          type: 'resizing',\n          xAxisCorner,\n          yAxisCorner,\n        };\n        break;\n      }\n\n      case 'SELECT_BOX_AND_START_MOVE': {\n        const { id } = action.payload;\n        if (!id) return;\n        if (draft.mode === 'draw') {\n          draft.selectedRoi = undefined;\n          return;\n        }\n        const { rois } = draft;\n        draft.selectedRoi = id;\n        const roi = rois.find((roi) => roi.id === id);\n        assert(roi, 'ROI not found');\n        draft.action = 'moving';\n        roi.action = {\n          type: 'moving',\n        };\n        break;\n      }\n\n      case 'START_DRAW': {\n        startDraw(draft, action.payload);\n        break;\n      }\n\n      case 'MOUSE_MOVE': {\n        mouseMove(draft, action.payload);\n        break;\n      }\n\n      case 'END_ACTION': {\n        endAction(draft);\n        break;\n      }\n\n      case 'CANCEL_ACTION': {\n        cancelAction(draft);\n        break;\n      }\n      case 'ZOOM':\n        zoomAction(draft, action.payload);\n        break;\n      case 'RESET_ZOOM':\n        resetZoomAction(draft);\n        break;\n      default:\n        assertUnreachable(type);\n    }\n  });\n}\n","import { ReactNode, useMemo, useReducer } from 'react';\nimport { KbsProvider } from 'react-kbs';\n\nimport { CommittedRoi } from '../types/Roi';\nimport { createRoiFromCommittedRoi } from '../utilities/rois';\n\nimport {\n  roisContext,\n  roiDispatchContext,\n  committedRoisContext,\n  roiStateContext,\n  panZoomContext,\n} from './contexts';\nimport { ReactRoiState, roiReducer } from './roiReducer';\n\ninterface RoiProviderProps<T> {\n  children: ReactNode;\n  initialRois?: Array<CommittedRoi<T>>;\n}\n\nfunction createInitialState<T>(\n  committedRois: Array<CommittedRoi<T>>,\n): ReactRoiState<T> {\n  const size = { width: 1, height: 1 };\n  const roiInitialState: ReactRoiState<T> = {\n    mode: 'select',\n    action: 'idle',\n    size,\n    selectedRoi: undefined,\n    committedRois,\n    rois: committedRois.map((committedRoi) =>\n      createRoiFromCommittedRoi(committedRoi, size),\n    ),\n    panZoom: {\n      scale: 1,\n      translation: [0, 0],\n    },\n  };\n  return roiInitialState;\n}\n\nexport function RoiProvider<T>({\n  children,\n  initialRois = [],\n}: RoiProviderProps<T>) {\n  const roiInitialState = createInitialState<T>(initialRois);\n  const [state, dispatch] = useReducer(roiReducer, roiInitialState);\n  const { rois, committedRois, mode, selectedRoi, panZoom } = state;\n  const roiState = useMemo(() => {\n    return {\n      mode,\n      selectedRoi,\n    };\n  }, [mode, selectedRoi]);\n\n  return (\n    <KbsProvider>\n      <panZoomContext.Provider value={panZoom}>\n        <roiDispatchContext.Provider value={dispatch}>\n          <roisContext.Provider value={rois}>\n            <committedRoisContext.Provider value={committedRois}>\n              <roiStateContext.Provider value={roiState}>\n                {children}\n              </roiStateContext.Provider>\n            </committedRoisContext.Provider>\n          </roisContext.Provider>\n        </roiDispatchContext.Provider>\n      </panZoomContext.Provider>\n    </KbsProvider>\n  );\n}\n"],"names":["defaultModifiers","cleanShortcuts","inputs","result","input","definition","main","aliases","shortcutToObjects","shortcut","isMac","isMultiplatformCtrlKey","event","shortcutToKeys","shortcutObjectToKey","modifiers","boolToString","prefix","eventToKeyOrCode","bool","combineShortcuts","shortcuts","keys","key","inputElements","shouldIgnoreElement","element","useLastTriggerRef","useRef","getKeyDownHandler","lastTrigger","combinedShortcuts","code","keyOrCode","now","initialKbsState","kbsContext","createContext","kbsDispatchContext","useKbsDispatch","dispatch","useContext","kbsReducer","state","action","newInputs","cleanedShortcuts","KbsProvider","props","kbsState","kbsDispatch","useReducer","useEffect","handleKeyDown","_jsx","useKbsGlobal","roiStateContext","roiDispatchContext","committedRoisContext","roisContext","roiContainerRefContext","panZoomContext","useRoiDispatch","roiDispatch","resizeObservers","hasActiveObservations","ro","hasSkippedObservations","msg","deliverResizeLoopError","ResizeObserverBoxOptions","freeze","obj","ResizeObserverSize","inlineSize","blockSize","DOMRectReadOnly","x","y","width","height","_a","top","right","bottom","left","rectangle","isSVG","target","isHidden","_b","offsetWidth","offsetHeight","isElement","scope","isReplacedElement","global","cache","scrollRegexp","verticalRegexp","IE","parseDimension","pixel","size","switchSizes","zeroBoxes","calculateBoxSizes","forceRecalculation","cs","svg","removePadding","canScrollVertically","canScrollHorizontally","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTop","borderRight","borderBottom","borderLeft","horizontalPadding","verticalPadding","horizontalBorderArea","verticalBorderArea","horizontalScrollbarThickness","verticalScrollbarThickness","widthReduction","heightReduction","contentWidth","contentHeight","borderBoxWidth","borderBoxHeight","boxes","calculateBoxSize","observedBox","borderBoxSize","contentBoxSize","devicePixelContentBoxSize","ResizeObserverEntry","calculateDepthForNode","node","depth","parent","broadcastActiveObservations","shallowestDepth","callbacks","entries","ot","entry","targetDepth","_i","callbacks_1","callback","gatherActiveObservationsAtDepth","process","trigger","notify","cb","queueMicroTask","toggle_1","el_1","config","queueResizeObserver","watching","isWatching","CATCH_PERIOD","observerConfig","events","time","timeout","scheduled","Scheduler","_this","until","elementsHaveResized","name","scheduler","updateCount","n","skipNotifyOnElement","ResizeObservation","ResizeObserverDetail","resizeObserver","observerMap","getObservationIndex","observationTargets","i","ResizeObserverController","detail","options","firstObservation","index","lastObservation","ResizeObserver","usePassiveLayoutEffect","React","useLayoutEffect","useLatest","current","storedValue","React.useRef","React.useEffect","useLatest$1","Polyfill","_ref","useResizeObserver","getResizeObserver","storedCallback","didUnsubscribe","targetEl","observer","createResizeObserver","ticking","allEntries","obs","_ref2","triggered","cbs","_callbacks$get","_callbacks$get2","cbIndex","_resizeObserver","useRoiState","useRois","rois","usePanZoom","usePanZoomTransform","scale","translation","throttle","func","timeFrame","lastTime","args","ContainerComponent","children","id","roiState","panZoomTransform","ref","onWheel","useMemo","onMouseMove","onMouseUp","jsx","containerBoundingRect","jsxs","RoiContainer","assertUnreachable","message","assert","value","getAllCorners","roi","Box","style","label","className","cursorSize","RoiBoxCorner","corner","roiId","RoiBoxInternal","getStyle","isActive","Fragment","RoiBox","memo","RoiList","defaultGetStyle","_","selected","normalizeValue","max","denormalizeValue","normalizeBox","position","denormalizeBox","createInitialBox","createCommitedRoi","createRoi","committedRoi","createCommitedRoiFromRoi","createRoiFromCommittedRoi","otherRoiProps","renormalizeRoiPosition","oldSize","newSize","wFactor","hFactor","NOTHING","DRAFTABLE","DRAFT_STATE","die","error","getPrototypeOf","isDraft","isDraftable","isPlainObject","isMap","isSet","objectCtorString","proto","Ctor","each","iter","getArchtype","thing","has","prop","set","propOrOldValue","t","is","latest","shallowCopy","base","strict","descriptors","desc","deep","isFrozen","dontMutateFrozenCollections","_key","plugins","getPlugin","pluginKey","plugin","currentScope","getCurrentScope","createScope","parent_","immer_","usePatchesInScope","patchListener","revokeScope","leaveScope","revokeDraft","enterScope","immer2","draft","processResult","baseDraft","finalize","maybeFreeze","rootScope","path","childValue","finalizeProperty","resultEach","isSet2","parentState","targetObject","rootPath","targetIsSet","res","createProxyProxy","isArray","traps","objectTraps","arrayTraps","revoke","proxy","source","readPropFromProto","peek","prepareCopy","createProxy","getDescriptorFromProto","current2","currentState","markChanged","owner","fn","Immer2","recipe","defaultBase","self","base2","hasError","p","ip","patches","inversePatches","patch","applyPatchesImpl","currentImpl","copy","immer","produce","cancelAction","roiIndex","r","boundRoi","actionType","updateCommitedRoiPosition","normalizedBox","endAction","selectedRoi","committedRois","commitedRoi","newCommitedRoi","mouseMove","updateRoiBox","movement","movementX","movementY","resize","xAxisCorner","newX","newWidth","yAxisCorner","applyInverseX","panzoom","applyInverseY","startDraw","payload","emptyRoi","MAX_ZOOM","MIN_ZOOM","zoomAction","zoom","zoomScale","refBoundingClientRect","clientX","clientY","scaleNew","originalX","originalY","resetZoomAction","roiReducer","type","updatedData","createInitialState","RoiProvider","initialRois","roiInitialState","mode","panZoom"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,50]}